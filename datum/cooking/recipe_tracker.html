<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/cooking/recipe_tracker - Space Station 13</title></head><body><header><a href="index.html">Space Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/cooking/recipe_tracker.html#var">Var Details</a> - <a href="datum/cooking/recipe_tracker.html#proc">Proc Details</a></header><main><h1>recipe_tracker <aside>/<a href="datum.html">datum</a>/<a href="datum/cooking/recipe_tracker.html">cooking/recipe_tracker</a></aside> <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/cooking/recipe_tracker.dm#L11"><img src="git.png" width="16" height="16" title="code/modules/cooking/recipe_tracker.dm 11"></a></h1><p>A recipe tracker is an abstract representation of the progress that a
cooking container has made towards any of its possible recipe outcomes.</p>
<p>When items are added/steps are performed on a cooking container, the tracker
is responsible for determining what known recipes are possible after the
step occurs, and tracking whether or not the step was successful. Once a
step has been performed that ends a recipe and is successful, the tracker
coordinates with the winning recipe to create the result, using what it
knows about the steps performed to choose the quality and other attributes
of the output.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/cooking/recipe_tracker.html#var/container_uid">container_uid</a></th><td>The parent object holding the recipe tracker.</td></tr><tr><th><a href="datum/cooking/recipe_tracker.html#var/recipe_started">recipe_started</a></th><td>Tells if steps have been taken for this recipe.</td></tr><tr><th><a href="datum/cooking/recipe_tracker.html#var/recipes_all_applied_steps">recipes_all_applied_steps</a></th><td>A list of recipe types to list of step indices we know we've performed.
Ensures we don't perform e.g. optional steps we skipped on completion.</td></tr><tr><th><a href="datum/cooking/recipe_tracker.html#var/recipes_applied_step_data">recipes_applied_step_data</a></th><td>A list of recipe types to metadata returned from completing its steps.
This may include things like a custom message shown to the player, or
the UID of relevant items used for determining quality at recipe
completion.</td></tr><tr><th><a href="datum/cooking/recipe_tracker.html#var/recipes_last_completed_step">recipes_last_completed_step</a></th><td>A list of recipe types to the index of the latest step we know we've
gotten to.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/cooking/recipe_tracker.html#proc/process_item">process_item</a></th><td>Core function that checks if a object meets all the requirements for certain
recipe actions.</td></tr><tr><th><a href="datum/cooking/recipe_tracker.html#proc/process_item_wrap">process_item_wrap</a></th><td>Wrapper function for analyzing process_item internally.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/container_uid"><aside class="declaration">var </aside>container_uid <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/cooking/recipe_tracker.dm#L13"><img src="git.png" width="16" height="16" title="code/modules/cooking/recipe_tracker.dm 13"></a></h3><p>The parent object holding the recipe tracker.</p><h3 id="var/recipe_started"><aside class="declaration">var </aside>recipe_started <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/cooking/recipe_tracker.dm#L15"><img src="git.png" width="16" height="16" title="code/modules/cooking/recipe_tracker.dm 15"></a></h3><p>Tells if steps have been taken for this recipe.</p><h3 id="var/recipes_all_applied_steps"><aside class="declaration">var </aside>recipes_all_applied_steps <aside>– /list</aside> <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/cooking/recipe_tracker.dm#L21"><img src="git.png" width="16" height="16" title="code/modules/cooking/recipe_tracker.dm 21"></a></h3><p>A list of recipe types to list of step indices we know we've performed.
Ensures we don't perform e.g. optional steps we skipped on completion.</p><h3 id="var/recipes_applied_step_data"><aside class="declaration">var </aside>recipes_applied_step_data <aside>– /list</aside> <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/cooking/recipe_tracker.dm#L26"><img src="git.png" width="16" height="16" title="code/modules/cooking/recipe_tracker.dm 26"></a></h3><p>A list of recipe types to metadata returned from completing its steps.
This may include things like a custom message shown to the player, or
the UID of relevant items used for determining quality at recipe
completion.</p><h3 id="var/recipes_last_completed_step"><aside class="declaration">var </aside>recipes_last_completed_step <aside>– /list</aside> <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/cooking/recipe_tracker.dm#L18"><img src="git.png" width="16" height="16" title="code/modules/cooking/recipe_tracker.dm 18"></a></h3><p>A list of recipe types to the index of the latest step we know we've
gotten to.</p><h2 id="proc">Proc Details</h2><h3 id="proc/process_item"><aside class="declaration">proc </aside>process_item<aside>(/<a href="mob.html">mob</a>/user, /<a href="obj.html">obj</a>/used)  <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/cooking/recipe_tracker.dm#L73"><img src="git.png" width="16" height="16" title="code/modules/cooking/recipe_tracker.dm 73"></a></aside></h3><p>Core function that checks if a object meets all the requirements for certain
recipe actions.</p>
<p>This is one of the thornier and grosser parts of the cooking system and most
people working with it or implementing recipes should never have to look at
this. The core idea is:</p>
<ul>
<li>we keep track of what recipes are still valid outcomes by testing the used
item against the list of recipes which are valid so far.</li>
<li>each valid recipe is at a certain step, and check the used object against
<a href="datum/cooking/recipe_step.html#proc/check_conditions_met" title="/datum/cooking/recipe_step">/datum/cooking/recipe_step/proc/check_conditions_met</a>. if we meet the
conditions, we track the recipe and the step.</li>
<li>for each unique step type that we're tracking, call
<a href="datum/cooking/recipe_step.html#proc/follow_step" title="/datum/cooking/recipe_step">/datum/cooking/recipe_step/proc/follow_step</a> on the first instance of
that step type, then <a href="datum/cooking/recipe_step.html#proc/is_complete" title="/datum/cooking/recipe_step">/datum/cooking/recipe_step/proc/is_complete</a> on
all recipe step instances of that type, to see if we advance their
respective recipes.</li>
</ul>
<p>Once a recipe reaches its final step, the tracker completes the recipe and
typically stops existing at that point.</p><h3 id="proc/process_item_wrap"><aside class="declaration">proc </aside>process_item_wrap<aside>(/<a href="mob.html">mob</a>/user, /<a href="obj.html">obj</a>/used)  <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/cooking/recipe_tracker.dm#L42"><img src="git.png" width="16" height="16" title="code/modules/cooking/recipe_tracker.dm 42"></a></aside></h3><p>Wrapper function for analyzing process_item internally.</p></main><footer>paradise.dme <a href="https://github.com/ParadiseSS13/Paradise/tree/506e5b7f5d9e45eafbcfc840b775ca69dee16715">506e5b7</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>