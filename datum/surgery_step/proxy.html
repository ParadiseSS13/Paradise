<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../"><link rel="stylesheet" href="dmdoc.css"><title>/datum/surgery_step/proxy - Space Station 13</title></head><body><header><a href="index.html">Space Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="datum/surgery_step/proxy.html#var">Var Details</a> - <a href="datum/surgery_step/proxy.html#proc">Proc Details</a></header><main><h1>proxy <aside>/<a href="datum.html">datum</a>/<a href="datum/surgery_step.html">surgery_step</a>/<a href="datum/surgery_step/proxy.html">proxy</a></aside> <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/surgery/abstract_steps.dm#L31"><img src="git.png" width="16" height="16" title="code/modules/surgery/abstract_steps.dm 31"></a></h1><p>Here's the special sauce: a surgery step that can pretend to be a few different surgery steps.
These proxy steps will, depending on the tool that's used, either continue to the next surgery step, or temporarily spin off a new surgery
by adding new steps to the current surgery.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="datum/surgery_step/proxy.html#var/branches">branches</a></th><td>Optional surgery TYPES that we can branch out to
Note that these must not share any starting tools.</td></tr><tr><th><a href="datum/surgery_step/proxy.html#var/branches_init">branches_init</a></th><td>Initialized versions of types specified in branches.
Don't fill this yourself, instead fill branches with surgery TYPES.</td></tr><tr><th><a href="datum/surgery_step/proxy.html#var/insert_self_after">insert_self_after</a></th><td>Whether or not we should add ourselves as a step after we run a branch. This doesn't apply to failures, those will always add ourselves after.</td></tr><tr><th><a href="datum/surgery_step/proxy.html#var/overriding_tools">overriding_tools</a></th><td>These tools are just...special cases.
If we're using one of these tools and there's a tool conflict with the original surgery,
just ignore any branches and continue with the original surgery.</td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="datum/surgery_step/proxy.html#proc/try_next_step">try_next_step</a></th><td>Test the next step, but don't fully commit to it unless it completes successfully.
If the next step doesn't fully complete (such as being interrupted or failing), we'll insert ourselves again to bring us back
to the &quot;base&quot; state.
If it does, we'll add the subsequent steps to the surgery and continue down the expected branch. If you complete the surgery step, it
means you've committed to what comes next.
Part of the motivation behind this is that I don't want to mutate a surgery retroactively. We can insert, but we shouldn't be changing anything
behind us.</td></tr></table><h2 id="var">Var Details</h2><h3 id="var/branches"><aside class="declaration">var </aside>branches <aside>– /list</aside> <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/surgery/abstract_steps.dm#L35"><img src="git.png" width="16" height="16" title="code/modules/surgery/abstract_steps.dm 35"></a></h3><p>Optional surgery TYPES that we can branch out to
Note that these must not share any starting tools.</p><h3 id="var/branches_init"><aside class="declaration">var </aside>branches_init <aside>– /list/<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a></aside> <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/surgery/abstract_steps.dm#L39"><img src="git.png" width="16" height="16" title="code/modules/surgery/abstract_steps.dm 39"></a></h3><p>Initialized versions of types specified in branches.
Don't fill this yourself, instead fill branches with surgery TYPES.</p><h3 id="var/insert_self_after"><aside class="declaration">var </aside>insert_self_after <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/surgery/abstract_steps.dm#L49"><img src="git.png" width="16" height="16" title="code/modules/surgery/abstract_steps.dm 49"></a></h3><p>Whether or not we should add ourselves as a step after we run a branch. This doesn't apply to failures, those will always add ourselves after.</p><h3 id="var/overriding_tools"><aside class="declaration">var </aside>overriding_tools <aside>– /list</aside> <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/surgery/abstract_steps.dm#L44"><img src="git.png" width="16" height="16" title="code/modules/surgery/abstract_steps.dm 44"></a></h3><p>These tools are just...special cases.
If we're using one of these tools and there's a tool conflict with the original surgery,
just ignore any branches and continue with the original surgery.</p><h2 id="proc">Proc Details</h2><h3 id="proc/try_next_step"><aside class="declaration">proc </aside>try_next_step<aside>(/<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/user, /<a href="mob.html">mob</a>/<a href="mob/living.html">living</a>/<a href="mob/living/carbon.html">carbon</a>/target, target_zone, /<a href="obj.html">obj</a>/<a href="obj/item.html">item</a>/tool, /<a href="datum.html">datum</a>/<a href="datum/surgery.html">surgery</a>/running_surgery, /list/next_surgery_steps, override_adding_self, readd_step_on_fail)  <a href="https://github.com/ParadiseSS13/Paradise/blob/506e5b7f5d9e45eafbcfc840b775ca69dee16715/code/modules/surgery/abstract_steps.dm#L207"><img src="git.png" width="16" height="16" title="code/modules/surgery/abstract_steps.dm 207"></a></aside></h3><p>Test the next step, but don't fully commit to it unless it completes successfully.
If the next step doesn't fully complete (such as being interrupted or failing), we'll insert ourselves again to bring us back
to the &quot;base&quot; state.
If it does, we'll add the subsequent steps to the surgery and continue down the expected branch. If you complete the surgery step, it
means you've committed to what comes next.
Part of the motivation behind this is that I don't want to mutate a surgery retroactively. We can insert, but we shouldn't be changing anything
behind us.</p>
<p>Arguments:</p>
<ul>
<li>next_surgery_steps - the steps for the branching surgery to add to the current surgery. If there's no branching surgery (or this would continue the main surgery) ignore this.</li>
<li>override_adding_self - If true, then on a successful surgery, regardless of the value of insert_self_after, we won't add ourselves in as another step.</li>
<li>readd_step_on_fail - If true, when we fail a step we'll add the failed step again after the proxy surgery. This is necessary for main surgeries.
(for other arguments, see try_op())</li>
</ul></main><footer>paradise.dme <a href="https://github.com/ParadiseSS13/Paradise/tree/506e5b7f5d9e45eafbcfc840b775ca69dee16715">506e5b7</a> (master) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.11.0</a></footer></body></html>