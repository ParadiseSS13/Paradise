<!--
Title: Mech Fabricator UI
Used In File(s): code\game\mecha\mech_fabricator.dm
-->

<!--
#define MECHFAB_MAIN_MENU		1
#define MECHFAB_CATEGORY_MENU	2
#define MECHFAB_SEARCH_MENU		3
#define MECHFAB_MATERIALS_MENU	4
-->

<style type="text/css">
	input[type=text], input[type=submit] {
		border: 1px solid #161616;
		background-color: #40628a;
		color: #FFFFFF;
		padding: 4px;
	}
	input[type=submit]:hover {
		background-color: #507aac;
	}
</style>

{{if data.screen == 1}}
	<div class='item'>
		{{:helper.link('Material Storage', 'arrow-up', {'material_storage': 1})}}
		{{:helper.link('Sync with R&D Server', 'refresh', {'sync': 1})}}
	</div>
{{else data.screen == 2 || data.screen == 3}}
	<div class='item'>
		{{:helper.link('Main Menu', 'reply', {'menu' : 1})}}
		{{:helper.link('Material Storage', 'arrow-up', {'material_storage': 1})}}
		{{:helper.link('Sync with R&D Server', 'refresh', {'sync': 1})}}
	</div>
{{else data.screen == 4}}
	<div class='item'>
		{{:helper.link('Main Menu', 'reply', {'menu' : 1})}}
		{{:helper.link('Sync with R&D Server', 'refresh', {'sync': 1})}}
	</div>
{{/if}}

<table style='width:100%'><tr>
	<td valign='top' style='margin-right: 300px'>
		<div class='statusDisplay'>
			{{if data.screen == 1}} <!-- MECHFAB_MAIN_MENU -->
				<h3>Exosuit Fabricator Menu</h3>
				<div class='itemLabelWidest'><table>
					<tr>
						<td><b>Total Material Amount:</b> {{:data.total_amount}} / {{:data.max_amount}} cm<sup>3</sup></td>
					</tr>
				</table></div>
				<form action='byond://'>
					<input type='hidden' name='src' value='{{:data.uid}}'>
					<input type='hidden' name='search' value='1'>
					<input type='text' name='to_search'>   <input type='submit' value='Search'>
				</form>

				<hr>
				<table class='item'><tr>
					{{for data.categories}}
						{{if (index & 1) == 0 && index != 0}}
							</tr><tr>
						{{/if}}
						<td>{{:helper.link(value, 'arrow-right', {'category': value})}} {{:helper.link('+All', '', {'main_menu_add_all' : value})}}</td>
					{{/for}}
				</tr></table>
			{{else data.screen == 2 || data.screen == 3}}
				{{if data.screen == 2}} <!-- MECHFAB_CATEGORY_MENU -->
					<h3>Viewing Category {{:data.selected_category}}:</h3>
				{{else data.screen == 3}} <!-- MECHFAB_SEARCH_MENU -->
					<h3>Search Results for '{{:data.search}}':</h3>
				{{/if}}
				<div class='itemLabelWidest'><table>
					<tr>
						<td><b>Total Material Amount:</b> {{:data.total_amount}} / {{:data.max_amount}} cm<sup>3</sup></td>
					</tr>
				</table></div>
				{{if data.screen != 3}}
					<table>
						<tr>
							<td>{{:helper.link('Add all parts to queue', null, {'category_add_all' : 'category'})}}</td>
						</tr>
					</table>
				{{/if}}

				<hr>
				<table>
					{{if data.designs.length}}
						{{for data.designs}}
							<tr>
								<td>
									{{:helper.link(value.name, 'print', {'add_to_queue' : value.id})}}
								</td>
								<td>
									{{for value.materials : material : i}}
										{{if material.amount}}
											 | 
											{{if material.is_red}}
												<span class='bad'>
											{{/if}}
											{{:material.amount}} {{:material.name}}
											{{if material.is_red}}
												</span>
											{{/if}}
										{{/if}}
									{{/for}}
								</td>
							</tr>
						{{/for}}
					{{else}}
						{{if data.screen == 2}}
							<ol class='average'>No designs currently available</ol>
						{{else data.screen == 3}}
							<br>
							<ol class='average'>No designs found</ol>
						{{/if}}
					{{/if}}
				</table>
			{{else data.screen == 4}}
				<table>
					<tr>
						<h3>Material Storage:</h3>
					</tr>
					{{for data.loaded_materials}}
						<div class='item'>
							<div class='itemLabel'> - {{:value.amount}} of {{:value.name}}</div> <div class='itemLabelNarrow'>({{:Math.round((value.amount / 2000) * 10) / 10}} sheets)</div>
							{{if value.amount >= 2000}}
								{{:helper.link('1x', 'eject', {'remove_mat': value.id, 'remove_mat_amount': 1})}}
								{{if value.amount >= 2000*5}}
									{{:helper.link('5x', 'eject', {'remove_mat': value.id, 'remove_mat_amount': 5})}}
								{{/if}}
								{{:helper.link('C', 'eject', {'remove_mat': value.id, 'remove_mat_amount': 'custom'})}}
								{{:helper.link('All', 'eject', {'remove_mat': value.id, 'remove_mat_amount': 50})}}
							{{/if}}
							</div>
						</div>
					{{/for}}
				</table>
			{{/if}}
		</div>
	</td>
	{{if data.screen != 4}}
		<td valign='top' style='width: 300px'>
			<div class="statusDisplay">
				<h3>Queue contains:</h3>
				{{if data.queue}}
					{{if data.processing}}
						<ol class='good'>{{:data.processing}}</ol>
					{{/if}}
					<ol>
						{{for data.queue}}
							<li>
								{{if !value.can_build}}
									<span class='bad'>
								{{/if}}
								{{:value.name}}
								{{if !value.can_build}}
									</span>
								{{/if}}
								<div class='item'>
									{{if index + 1 > 1}}
										{{:helper.link('', 'arrow-up', {'curr_index' : index + 1, 'new_index' : index})}}
									{{/if}}
									{{if index + 1 < data.queue.length}}
										{{:helper.link('', 'arrow-down', {'curr_index' : index + 1, 'new_index' : index + 2})}}
									{{/if}}
									{{:helper.link('Remove', 'times', {'remove_from_queue' : index + 1})}}
								</div>
							</li>
						{{/for}}
					</ol>
					{{:helper.link('Process queue', 'print', {'process_queue' : 1})}} {{:helper.link('Clear queue', 'trash', {'clear_queue' : 1})}}
				{{else}}
					{{if data.processing}}
						<ol class='good'>{{:data.processing}}</ol>
					{{else}}
						<ol class='average'>Nothing</ol>
					{{/if}}
				{{/if}}
			</div>
		</td>
	{{/if}}
</tr></table>

{{if data.wait_message}}
	<div class="mask">
		<div class="maskContent">
			<h1>{{:data.wait_message}}</h1>
		</div>
	</div>
{{/if}}