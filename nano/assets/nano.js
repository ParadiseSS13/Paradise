var NanoUtility=function(){var a={};return{init:function(){var e=$("body");a=e.data("urlParameters")},generateHref:function(e){var t="?";for(var n in a)a.hasOwnProperty(n)&&("?"!==t&&(t+=";"),t+=n+"="+a[n]);for(var n in e)e.hasOwnProperty(n)&&("?"!==t&&(t+=";"),t+=n+"="+e[n]);return t},winset:function(e,t,n){var a,r;return null==n&&(n=NanoStateManager.getData().config.window.ref),(a={})[n+"."+e]=t,r=a,location.href=NanoUtility.href("winset",r)},extend:function(n,a){return Object.keys(a).forEach(function(e){var t;return(t=a[e])&&"[object Object]"===Object.prototype.toString.call(t)?(n[e]=n[e]||{},NanoUtility.extend(n[e],t)):n[e]=t}),n},href:function(e,t){return null==e&&(e=""),null==t&&(t={}),e=new Url("byond://"+e),NanoUtility.extend(e.query,t),e},close:function(){var e;return e={command:"nanoclose "+a.src},this.winset("is-visible","false"),location.href=NanoUtility.href("winset",e)}}}();"undefined"==typeof jQuery&&reportError("ERROR: Javascript library failed to load!"),"undefined"==typeof doT&&reportError("ERROR: Template engine failed to load!");var reportError=function(e){window.location="byond://?nano_err="+encodeURIComponent(e),alert(e)};$(document).ready(function(){NanoUtility.init(),NanoStateManager.init(),NanoTemplate.init(),NanoWindow.init()}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length,n=Number(arguments[1])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=t);n<t;n++)if(n in this&&this[n]===e)return n;return-1}),String.prototype.format||(String.prototype.format=function(n){return this.replace(String.prototype.format.regex,function(e){var t=parseInt(e.substring(1,e.length-1));return 0<=t?n[t]:-1===t?"{":-2===t?"}":""})},String.prototype.format.regex=new RegExp("{-?[0-9]+}","g")),Object.size=function(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t},window.console||(window.console={log:function(e){return!1}}),String.prototype.toTitleCase=function(){var r=/^(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|vs?\.?|via)$/i;return this.replace(/([^\W_]+[^\s-]*) */g,function(e,t,n,a){return 0<n&&n+t.length!==a.length&&-1<t.search(r)&&":"!==a.charAt(n-2)&&a.charAt(n-1).search(/[^\s-]/)<0?e.toLowerCase():-1<t.substr(1).search(/[A-Z]|\../)?e:e.charAt(0).toUpperCase()+e.substr(1)})},$.ajaxSetup({cache:!1}),Function.prototype.inheritsFrom=function(e){return this.prototype=new e,(this.prototype.constructor=this).prototype.parent=e.prototype,this},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.ckey||(String.prototype.ckey=function(){return this.replace(/\W/g,"").toLowerCase()}),NanoStateManager=function(){var n=!1,a=null,r={},o={},i={},s=null,l=function(e){null!=s&&(!1!==(e=s.onBeforeUpdate(e))?(a=e,s.onUpdate(a),s.onAfterUpdate(a)):reportError("data is false, return"))},t=function(e,t){for(var n in e)e.hasOwnProperty(n)&&jQuery.isFunction(e[n])&&(t=e[n].call(this,t));return t};return{init:function(){!function(){null!=(a=$("body").data("initialData"))&&a.hasOwnProperty("config")&&a.hasOwnProperty("data")||reportError("Error: Initial data did not load correctly."+JSON.stringify(a));var e="default";a.config.hasOwnProperty("stateKey")&&a.config.stateKey&&(e=a.config.stateKey.toLowerCase()),NanoStateManager.setCurrentState(e),$(document).on("templatesLoaded",function(){l(a),n=!0})}()},receiveUpdateData:function(e){!function(e){var t;try{t=jQuery.parseJSON(e)}catch(e){return reportError("recieveUpdateData failed. <br>Error name: "+e.name+"<br>Error Message: "+e.message)}t.hasOwnProperty("data")||(a&&a.hasOwnProperty("data")?t.data=a.data:t.data={}),n?l(t):a=t}(e)},addBeforeUpdateCallback:function(e,t){r[e]=t},addBeforeUpdateCallbacks:function(e){for(var t in e)e.hasOwnProperty(t)&&NanoStateManager.addBeforeUpdateCallback(t,e[t])},removeBeforeUpdateCallback:function(e){r.hasOwnProperty(e)&&delete r[e]},executeBeforeUpdateCallbacks:function(e){return t(r,e)},addAfterUpdateCallback:function(e,t){o[e]=t},addAfterUpdateCallbacks:function(e){for(var t in e)e.hasOwnProperty(t)&&NanoStateManager.addAfterUpdateCallback(t,e[t])},removeAfterUpdateCallback:function(e){o.hasOwnProperty(e)&&delete o[e]},executeAfterUpdateCallbacks:function(e){return t(o,e)},addState:function(e){e instanceof NanoStateClass?e.key?i[e.key]=e:reportError("ERROR: Attempted to add a state with an invalid stateKey"):reportError("ERROR: Attempted to add a state which is not instanceof NanoStateClass")},setCurrentState:function(e){if(void 0===e||!e)return reportError("ERROR: No state key was passed!"),!1;if(!i.hasOwnProperty(e))return reportError("ERROR: Attempted to set a current state which does not exist: "+e),!1;var t=s;return s=i[e],null!=t&&t.onRemove(s),s.onAdd(t),!0},getCurrentState:function(){return s},getData:function(){return a}}}(),NanoBaseCallbacks=function(){var a=!0,t={},n={status:function(n){var e;return 2==n.config.status?(e="good",$(".linkActive").removeClass("inactive")):(e=1==n.config.status?"average":"bad",$(".linkActive").addClass("inactive")),$(".statusicon").removeClass("good bad average").addClass(e),$(".linkActive").stopTime("linkPending"),$(".linkActive").removeClass("linkPending"),$(".linkActive").off("click").on("click",function(e){e.preventDefault();var t=$(this).data("href");null!=t&&a&&(a=!1,$("body").oneTime(300,"enableClick",function(){a=!0}),2==n.config.status&&$(this).oneTime(300,"linkPending",function(){$(this).addClass("linkPending")}),window.location.href=t)}),n},nanomap:function(e){return $(".mapIcon").off("mouseenter mouseleave").on("mouseenter",function(e){$("#uiMapTooltip").html($(this).children(".tooltip").html()).show().stopTime().oneTime(5e3,"hideTooltip",function(){$(this).fadeOut(500)})}),$(".zoomLink").off("click").on("click",function(e){e.preventDefault();var t=$(this).data("zoomLevel"),n=$("#uiMap"),a=n.width()*t,r=n.height()*t;n.css({zoom:t,left:"50%",top:"50%",marginLeft:"-"+Math.floor(a/2)+"px",marginTop:"-"+Math.floor(r/2)+"px"})}),$("#uiMapImage").attr("src",e.config.map+"_nanomap_z"+e.config.mapZLevel+".png"),e}};return{addCallbacks:function(){NanoStateManager.addBeforeUpdateCallbacks(t),NanoStateManager.addAfterUpdateCallbacks(n)},removeCallbacks:function(){for(var e in t)t.hasOwnProperty(e)&&NanoStateManager.removeBeforeUpdateCallback(e);for(var e in n)n.hasOwnProperty(e)&&NanoStateManager.removeAfterUpdateCallback(e)}}}(),NanoBaseHelpers=function(){var t={syndicateMode:function(){return $(".mainBG").css("background","url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4wIiB2aWV3Qm94PSIwIDAgNDAwIDIwMCIgb3BhY2l0eT0iLjI1Ij4NCgk8cG9seWdvbiBwb2ludHM9IjI1MCwwIDE1MCwwIDEwMCw1MCI+PC9wb2x5Z29uPg0KCTxwb2x5Z29uIHBvaW50cz0iMTAwLDUwIDE1MCwyNSAyMDAsNjUgMjUwLDE1MCI+PC9wb2x5Z29uPg0KCTxwb2x5Z29uIHBvaW50cz0iMjUwLDE1MCAyMDAsOTAgMTAwLDIwMCI+PC9wb2x5Z29uPg0KPC9zdmc+') no-repeat fixed center/70% 70%, linear-gradient(to bottom, #8f1414 0%, #4B0A0A 100%) no-repeat fixed center/100% 100%;"),$("#uiTitleFluff").css("background-image","url('uiTitleFluff-Syndicate.png')"),$("#uiTitleFluff").css("background-position","50% 50%"),$("#uiTitleFluff").css("background-repeat","no-repeat"),""},combine:function(e,t){return e&&t?e.concat(t):e||t},dump:function(e){return JSON.stringify(e)},link:function(e,t,n,a,r,o){var i="",s="noIcon";void 0!==t&&t&&(i='<div class="uiLinkPendingIcon"></div><i class="fa fa-fw fa-'+t+'"></i>',s="hasIcon"),void 0!==r&&r||(r="link");var l="";void 0!==o&&o&&(l='id="'+o+'"');var c=NanoTransition.allocID(l+"_"+e.toString().replace(/[^a-z0-9_]/gi,"_")+"_"+t);return void 0!==a&&a?'<div unselectable="on" class="link '+s+" "+c+'" '+l+">"+i+e+'</div><script>$(function() { var newState = {"..class": "'+r+" "+a+'"}; var old = NanoTransition.transitionElement("'+c+'", null, newState, 200); NanoTransition.animateHover("'+c+'", null, old, newState); });<\/script>':'<div unselectable="on" class="linkActive '+s+" "+c+'" data-href="'+NanoUtility.generateHref(n)+'" '+l+">"+i+e+'</div><script>$(function() { var newState = {"..class": "'+r+'"}; var old = NanoTransition.transitionElement("'+c+'", null, newState, 200); NanoTransition.animateHover("'+c+'", null, old, newState); });<\/script>'},xor:function(e,t){return e^t},precisionRound:function(e,t){if(0==t)return Math.round(number);var n=Math.pow(10,t);return Math.round(e*n)/n},round:function(e){return Math.round(e)},fixed:function(e){return Math.round(10*e)/10},floor:function(e){return Math.floor(e)},ceil:function(e){return Math.ceil(e)},string:function(){if(0==arguments.length)return"";if(1==arguments.length)return arguments[0];if(1<arguments.length){stringArgs=[];for(var e=1;e<arguments.length;e++)stringArgs.push(arguments[e]);return arguments[0].format(stringArgs)}return""},formatNumber:function(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")},capitalizeFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},displayBar:function(e,t,n,a,r){t<n?e<t?e=t:n<e&&(e=n):t<e?e=t:e<n&&(e=n),void 0!==a&&a||(a=""),void 0!==r&&r||(r="");var o=Math.round((e-t)/(n-t)*100),i=NanoTransition.allocID(t+"_"+n);return'<div class="displayBar '+i+" "+a+'"><div class="displayBarFill"></div><div class="displayBarText '+a+'">'+r+'</div></div><script>$(function() { NanoTransition.transitionElement("'+i+'", ".displayBarFill", {width: "'+o+'%", "..class": "'+a+'"}); });<\/script>'},dangerToClass:function(e){return 0==e?"good":1==e?"average":"bad"},dangerToSpan:function(e){return 0==e?'"<span class="good">Good</span>"':1==e?'"<span class="average">Minor Alert</span>"':'"<span class="bad">Major Alert</span>"'},generateHref:function(e){var t=$("body");_urlParameters=t.data("urlParameters");var n="?";for(var a in _urlParameters)_urlParameters.hasOwnProperty(a)&&("?"!==n&&(n+=";"),n+=a+"="+_urlParameters[a]);for(var a in e)e.hasOwnProperty(a)&&("?"!==n&&(n+=";"),n+=a+"="+e[a]);return n},displayDNABlocks:function(e,t,n,a,r){if(!e)return'<div class="notice">Please place a valid subject into the DNA modifier.</div>';var o=e.split(""),i='<div class="dnaBlock"><div class="link dnaBlockNumber">1</div>',s=1,l=1;for(var c in o)if(o.hasOwnProperty(c)&&"object"!=typeof o[c]){var d;d="UI"==r.toUpperCase()?{selectUIBlock:s,selectUISubblock:l}:{selectSEBlock:s,selectSESubblock:l};var u="linkActive";s==t&&l==n&&(u="selected"),i+='<div class="link '+u+' dnaSubBlock" data-href="'+NanoUtility.generateHref(d)+'" id="dnaBlock'+c+'">'+o[c]+"</div>",++c%a==0&&c<o.length?(l=1,i+='</div><div class="dnaBlock"><div class="link dnaBlockNumber">'+ ++s+"</div>"):l++}return i+="</div>"},cMirror:function(e){CodeMirror.fromTextArea(document.getElementById(e),{lineNumbers:!0,indentUnit:4,indentWithTabs:!0,theme:"lesser-dark"})},smoothNumber:function(e){var t=NanoTransition.allocID("n");return'<span class="'+t+'"></span><script>$(function() { var newState = {value: '+e+'}; var old = NanoTransition.updateElement("'+t+'", newState); NanoTransition.animateTextValue("'+t+'", null, -1, old["value"], newState["value"]); });<\/script>'},smoothRound:function(e,t){var n=NanoTransition.allocID(t);return void 0===t&&(placed=0),'<span class="'+n+'"></span><script>$(function() { var newState = {value: '+e.toFixed(t)+'}; var old = NanoTransition.updateElement("'+n+'", newState); NanoTransition.animateTextValue("'+n+'", null, '+t+', old["value"], newState["value"]); });<\/script>'}};return{addHelpers:function(){NanoTemplate.addHelpers(t)},removeHelpers:function(){for(var e in t)t.hasOwnProperty(e)&&NanoTemplate.removeHelper(e)}}}(),NanoStateDefaultClass.inheritsFrom(NanoStateClass);var NanoStateDefault=new NanoStateDefaultClass;function NanoStateDefaultClass(){this.key="default",this.key=this.key.toLowerCase(),NanoStateManager.addState(this)}NanoStatePDAClass.inheritsFrom(NanoStateClass);var NanoStatePDA=new NanoStatePDAClass;function NanoStatePDAClass(){this.key="pda",this.key=this.key.toLowerCase(),this.current_template="",NanoStateManager.addState(this)}function NanoStateClass(){}NanoStatePDAClass.prototype.onUpdate=function(t){NanoStateClass.prototype.onUpdate.call(this,t);var n=this;try{if(null!=t.data.app){var a=t.data.app.template;null!=a&&a!=n.current_template?$.when($.ajax({url:a+".tmpl",cache:!1,dataType:"text"})).done(function(e){e+='<div class="clearBoth"></div>';try{NanoTemplate.addTemplate("app",e),NanoTemplate.resetTemplate("app"),$("#uiApp").html(NanoTemplate.parse("app",t)),n.current_template=a,n.onAfterUpdate(t)}catch(e){return void reportError("ERROR: An error occurred while loading the PDA App UI: "+e.message)}}).fail(function(){reportError("ERROR: Loading template app("+a+") failed!")}):NanoTemplate.templateExists("app")&&$("#uiApp").html(NanoTemplate.parse("app",t))}}catch(e){return void reportError("ERROR: An error occurred while rendering the PDA App UI: "+e.message)}},NanoStateClass.prototype.key=null,NanoStateClass.prototype.layoutRendered=!1,NanoStateClass.prototype.contentRendered=!1,NanoStateClass.prototype.mapInitialised=!1,NanoStateClass.prototype.isCurrent=function(){return NanoStateManager.getCurrentState()==this},NanoStateClass.prototype.onAdd=function(e){NanoBaseCallbacks.addCallbacks(),NanoBaseHelpers.addHelpers()},NanoStateClass.prototype.onRemove=function(e){NanoBaseCallbacks.removeCallbacks(),NanoBaseHelpers.removeHelpers()},NanoStateClass.prototype.onBeforeUpdate=function(e){return e=NanoStateManager.executeBeforeUpdateCallbacks(e)},NanoStateClass.prototype.onUpdate=function(e){try{(!this.layoutRendered||e.config.hasOwnProperty("autoUpdateLayout")&&e.config.autoUpdateLayout)&&($("#uiLayout").html(NanoTemplate.parse("layout",e)),this.layoutRendered=!0),(!this.contentRendered||e.config.hasOwnProperty("autoUpdateContent")&&e.config.autoUpdateContent)&&($("#uiContent").html(NanoTemplate.parse("main",e)),this.contentRendered=!0),NanoTemplate.templateExists("mapContent")&&(this.mapInitialised||($("#uiMap").draggable(),$("#uiMapTooltip").off("click").on("click",function(e){e.preventDefault(),$(this).fadeOut(400)}),this.mapInitialised=!0),$("#uiMapContent").html(NanoTemplate.parse("mapContent",e)),e.config.hasOwnProperty("showMap")&&e.config.showMap?($("#uiContent").addClass("hidden"),$("#uiMapWrapper").removeClass("hidden")):($("#uiMapWrapper").addClass("hidden"),$("#uiContent").removeClass("hidden"))),NanoTemplate.templateExists("mapHeader")&&$("#uiMapHeader").html(NanoTemplate.parse("mapHeader",e)),NanoTemplate.templateExists("mapFooter")&&$("#uiMapFooter").html(NanoTemplate.parse("mapFooter",e))}catch(e){return void reportError("ERROR: An error occurred while rendering the UI: "+e.message)}},NanoStateClass.prototype.onAfterUpdate=function(e){NanoStateManager.executeAfterUpdateCallbacks(e)},NanoStateClass.prototype.alertText=function(e){alert(e)};var NanoTemplate=function(){var n={},a={},r={},o={},i=function(){if(Object.size(n)){for(var t in n)if(n.hasOwnProperty(t))return void $.when($.ajax({url:n[t],cache:!1,dataType:"text"})).done(function(e){e+='<div class="clearBoth"></div>';try{NanoTemplate.addTemplate(t,e)}catch(e){return void reportError("ERROR: An error occurred while loading the UI: "+e.message)}delete n[t],i()}).fail(function(){reportError("ERROR: Loading template "+t+"("+n[t]+") failed!")})}else $(document).trigger("templatesLoaded")};return{init:function(){null==(n=$("body").data("templateData"))&&reportError("Error: Template data did not load correctly."),i()},addTemplate:function(e,t){a[e]=t},templateExists:function(e){return a.hasOwnProperty(e)},resetTemplate:function(e){r[e]=null},parse:function(e,t){if(!r.hasOwnProperty(e)||!r[e]){if(!a.hasOwnProperty(e))return reportError('ERROR: Template "'+e+'" does not exist in _compiledTemplates!'),"<h2>Template error (does not exist)</h2>";!function(){for(var e in a)try{r[e]=doT.template(a[e],null,a)}catch(e){reportError(e.message)}}()}return"function"!=typeof r[e]?(reportError(r[e]),reportError('ERROR: Template "'+e+'" failed to compile!'),"<h2>Template error (failed to compile)</h2>"):r[e].call(this,t.data,t.config,o)},addHelper:function(e,t){jQuery.isFunction(t)?o[e]=t:reportError("NanoTemplate.addHelper failed to add "+e+" as it is not a function.")},addHelpers:function(e){for(var t in e)e.hasOwnProperty(t)&&NanoTemplate.addHelper(t,e[t])},removeHelper:function(e){helpers.hasOwnProperty(e)&&delete o[e]}}}();NanoTransition=function(){var s={},l={},t=0;NanoStateManager.addBeforeUpdateCallback("TransitionReset",function(e){return t=0,e});var i=function(e,t,n){var a,r=s[e];void 0===n&&(n=!1);var o=$("."+e);if(0==o.length)return t;if(o=o[0],r&&r.tagName==o.tagName&&r.tabIndex==o.tabIndex&&r.parent==o.parentNode.tagName&&r.children==o.children.length){if(a=l[e],n){var i={};for(k in a)i[k]=a[k];for(k in t)i[k]=t[k];t=i}}else a=t,s[e]={tagName:o.tagName,tabIndex:o.tabIndex,parent:o.parentNode.tagName,children:o.children.length};return l[e]=t,a},d=function(e,t){var n=$("."+e);return t?$(n).children(t):$(n)},o=function(e,t,n,a,r){var o=d(e,t);void 0===r&&(r=1900),o.css(n).animate(a,{duration:r,queue:!1});var i=n["..class"],s=a["..class"];if(i&&s&&(o.addClass(i),i!=s)){i=i.split(" "),s=s.split(" ");var l=i.filter(function(e){return-1==s.indexOf(e)}),c=s.filter(function(e){return-1==i.indexOf(e)});i=l.join(" "),s=c.join(" "),o.switchClass(i,s,{duration:r,queue:!1})}};return{allocID:function(e){return"_Hide_Map_close"==e?"transition__map":(void 0===e&&(e=""),"transition__"+t+++"_"+e.toString())},updateElement:i,animateElement:o,animateTextValue:function(e,t,n,a,r,o){var i=d(e,t);void 0===o&&(o=1900),-1==n?i.text(a.toString()):i.text(a.toFixed(n)),a!=r&&i.animate({i:1},{duration:o,queue:!1,step:function(e,t){t.elem.textContent=-1==n?(a*(1-e)+r*e).toString():(a*(1-e)+r*e).toFixed(n)}})},animateHover:function(e,t,n,a,r){var o=d(e,t);void 0===r&&(r=200),n["..hover"]&&o.addClass("hover"),o.hover(function(){o.stop(1,1).addClass("hover",{duration:r,queue:!1}),i(e,{"..hover":!0},!0)},function(){o.stop(1,1).removeClass("hover",{duration:r,queue:!1}),i(e,{"..hover":!1},!0)})},transitionElement:function(e,t,n,a){var r=i(e,n);return o(e,t,r,n,a),r}}}();var NanoWindow=function(){var u,p,a,f,h,m,v,g=function(e,t){NanoUtility.winset("pos",e+","+t)},w=function(e,t){NanoUtility.winset("size",e+","+t)},e=function(){var e=window.screenLeft,t=window.screenTop;g(0,0),u=window.screenLeft,p=window.screenTop;var n=e-u,a=t-p;g(n=n<u?0:n,a=a<p?0:a);var r=$(window).height(),o=$(window).width();$("body").height()>=$(window).height()-29&&(o+=17),$(document).width()>$(window).width()&&(r+=17);var i=Math.max(280,o),s=Math.max(140,r);w(i,s)},t=function(){NanoUtility.winset("titlebar",0),NanoUtility.winset("can-resize",0),NanoUtility.winset("transparent-color","#FF00E4"),$(".fancy").show(),$("#uiTitleFluff").css("right","72px"),$(".statusicon").css("left","34px"),$("#uiTitleText").css("left","66px")},n=function(){$(".close").on("click",function(e){NanoUtility.close()}),$(".minimize").on("click",function(e){NanoUtility.winset("is-minimized","true")})},r=function(){$("body").on("mousemove","#uiTitleWrapper",function(e){o(e)}),$("body").on("mousedown","#uiTitleWrapper",function(){a=!0,$(this)[0].setCapture&&$(this)[0].setCapture()}),$("body").on("mouseup","#uiTitleWrapper",function(){a=!1,$(this)[0].releaseCapture&&$(this)[0].releaseCapture()}),$("body").on("mousemove","div.resizeArea",function(e){i.call(this,e)}),$("body").on("mousedown","div.resizeArea",function(){m=!0,this.setCapture&&this.setCapture()}),$("body").on("mouseup","div.resizeArea",function(){m=!1,this.releaseCapture&&this.releaseCapture()})},o=function(e){if(e=e||window.event,f!==e.screenX||h!==e.screenY){if(void 0===f&&(f=e.screenX,h=e.clientY),a){var t=e.screenX-f,n=e.screenY-h;t+=window.screenLeft-u,n+=window.screenTop-p,g(t,n)}f=e.screenX,h=e.screenY}},i=function(e){if(!v){if(v=!0,e=e||window.event,void 0===f&&(f=e.screenX-u,h=e.screenY-p),m){var t=$(window).width(),n=$(window).height();$("body").height()>=$(window).height()-29&&(t+=17),$(document).width()>$(window).width()&&(n+=17);var a=Number($(this).attr("rx")),r=Number($(this).attr("ry")),o=e.screenX-u-f,i=e.screenY-p-h,s=window.screenLeft-u,l=window.screenTop-p,c=t+o*a;-1==a&&(s+=o);var d=n+i*r;-1==r&&(l+=i),c=Math.max(280,c),d=Math.max(140,d),g(s,l),w(c,d)}f=e.screenX-u,h=e.screenY-p,v=!1}};return{init:function(){$(document).on("templatesLoaded",function(){e(),NanoStateManager.getData().config.user.fancy&&(t(),e(),n(),r())})}}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5hbm8uanMiXSwibmFtZXMiOlsiTmFub1V0aWxpdHkiLCJfdXJsUGFyYW1ldGVycyIsImluaXQiLCJib2R5IiwiJCIsImRhdGEiLCJnZW5lcmF0ZUhyZWYiLCJwYXJhbWV0ZXJzIiwicXVlcnlTdHJpbmciLCJrZXkiLCJoYXNPd25Qcm9wZXJ0eSIsIndpbnNldCIsInZhbHVlIiwid2luZG93Iiwib2JqIiwicGFyYW1zIiwiTmFub1N0YXRlTWFuYWdlciIsImdldERhdGEiLCJjb25maWciLCJyZWYiLCJsb2NhdGlvbiIsImhyZWYiLCJleHRlbmQiLCJmaXJzdCIsInNlY29uZCIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwic2Vjb25kVmFsIiwicHJvdG90eXBlIiwidG9TdHJpbmciLCJjYWxsIiwidXJsIiwiVXJsIiwicXVlcnkiLCJjbG9zZSIsImNvbW1hbmQiLCJzcmMiLCJ0aGlzIiwialF1ZXJ5IiwicmVwb3J0RXJyb3IiLCJkb1QiLCJzdHIiLCJlbmNvZGVVUklDb21wb25lbnQiLCJhbGVydCIsImRvY3VtZW50IiwicmVhZHkiLCJOYW5vVGVtcGxhdGUiLCJOYW5vV2luZG93IiwiQXJyYXkiLCJpbmRleE9mIiwiZWx0IiwibGVuIiwibGVuZ3RoIiwiZnJvbSIsIk51bWJlciIsImFyZ3VtZW50cyIsIk1hdGgiLCJjZWlsIiwiZmxvb3IiLCJTdHJpbmciLCJmb3JtYXQiLCJhcmdzIiwicmVwbGFjZSIsInJlZ2V4IiwiaXRlbSIsImludFZhbCIsInBhcnNlSW50Iiwic3Vic3RyaW5nIiwiUmVnRXhwIiwic2l6ZSIsImNvbnNvbGUiLCJsb2ciLCJ0b1RpdGxlQ2FzZSIsInNtYWxsV29yZHMiLCJtYXRjaCIsInAxIiwiaW5kZXgiLCJ0aXRsZSIsInNlYXJjaCIsImNoYXJBdCIsInRvTG93ZXJDYXNlIiwic3Vic3RyIiwidG9VcHBlckNhc2UiLCJhamF4U2V0dXAiLCJjYWNoZSIsIkZ1bmN0aW9uIiwiaW5oZXJpdHNGcm9tIiwicGFyZW50Q2xhc3NPck9iamVjdCIsImNvbnN0cnVjdG9yIiwicGFyZW50IiwidHJpbSIsImNrZXkiLCJfaXNJbml0aWFsaXNlZCIsIl9kYXRhIiwiX2JlZm9yZVVwZGF0ZUNhbGxiYWNrcyIsIl9hZnRlclVwZGF0ZUNhbGxiYWNrcyIsIl9zdGF0ZXMiLCJfY3VycmVudFN0YXRlIiwiZG9VcGRhdGUiLCJvbkJlZm9yZVVwZGF0ZSIsIm9uVXBkYXRlIiwib25BZnRlclVwZGF0ZSIsImV4ZWN1dGVDYWxsYmFja3MiLCJjYWxsYmFja3MiLCJpc0Z1bmN0aW9uIiwiSlNPTiIsInN0cmluZ2lmeSIsInN0YXRlS2V5Iiwic2V0Q3VycmVudFN0YXRlIiwib24iLCJyZWNlaXZlVXBkYXRlRGF0YSIsImpzb25TdHJpbmciLCJ1cGRhdGVEYXRhIiwicGFyc2VKU09OIiwiZXJyb3IiLCJuYW1lIiwibWVzc2FnZSIsImFkZEJlZm9yZVVwZGF0ZUNhbGxiYWNrIiwiY2FsbGJhY2tGdW5jdGlvbiIsImFkZEJlZm9yZVVwZGF0ZUNhbGxiYWNrcyIsImNhbGxiYWNrS2V5IiwicmVtb3ZlQmVmb3JlVXBkYXRlQ2FsbGJhY2siLCJleGVjdXRlQmVmb3JlVXBkYXRlQ2FsbGJhY2tzIiwiYWRkQWZ0ZXJVcGRhdGVDYWxsYmFjayIsImFkZEFmdGVyVXBkYXRlQ2FsbGJhY2tzIiwicmVtb3ZlQWZ0ZXJVcGRhdGVDYWxsYmFjayIsImV4ZWN1dGVBZnRlclVwZGF0ZUNhbGxiYWNrcyIsImFkZFN0YXRlIiwic3RhdGUiLCJOYW5vU3RhdGVDbGFzcyIsInByZXZpb3VzU3RhdGUiLCJvblJlbW92ZSIsIm9uQWRkIiwiZ2V0Q3VycmVudFN0YXRlIiwiTmFub0Jhc2VDYWxsYmFja3MiLCJfY2FuQ2xpY2siLCJfYmFzZUJlZm9yZVVwZGF0ZUNhbGxiYWNrcyIsIl9iYXNlQWZ0ZXJVcGRhdGVDYWxsYmFja3MiLCJzdGF0dXMiLCJ1aVN0YXR1c0NsYXNzIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsInN0b3BUaW1lIiwib2ZmIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsIm9uZVRpbWUiLCJuYW5vbWFwIiwiaHRtbCIsImNoaWxkcmVuIiwic2hvdyIsImZhZGVPdXQiLCJ6b29tTGV2ZWwiLCJ1aU1hcE9iamVjdCIsInVpTWFwV2lkdGgiLCJ3aWR0aCIsInVpTWFwSGVpZ2h0IiwiaGVpZ2h0IiwiY3NzIiwiem9vbSIsImxlZnQiLCJ0b3AiLCJtYXJnaW5MZWZ0IiwibWFyZ2luVG9wIiwiYXR0ciIsImFkZENhbGxiYWNrcyIsInJlbW92ZUNhbGxiYWNrcyIsIk5hbm9CYXNlSGVscGVycyIsIl9iYXNlSGVscGVycyIsInN5bmRpY2F0ZU1vZGUiLCJzeW5kaWNhdGVTVkciLCJjb21iaW5lIiwiYXJyMSIsImFycjIiLCJjb25jYXQiLCJkdW1wIiwibGluayIsInRleHQiLCJpY29uIiwiZWxlbWVudENsYXNzIiwiZWxlbWVudElkIiwiaWNvbkh0bWwiLCJpY29uQ2xhc3MiLCJlbGVtZW50SWRIdG1sIiwidGlkIiwiTmFub1RyYW5zaXRpb24iLCJhbGxvY0lEIiwieG9yIiwibnVtYmVyIiwiYml0IiwicHJlY2lzaW9uUm91bmQiLCJwbGFjZXMiLCJyb3VuZCIsIm11bHRpcGxpZXIiLCJwb3ciLCJmaXhlZCIsInN0cmluZyIsInN0cmluZ0FyZ3MiLCJpIiwicHVzaCIsImZvcm1hdE51bWJlciIsIngiLCJwYXJ0cyIsInNwbGl0Iiwiam9pbiIsImNhcGl0YWxpemVGaXJzdExldHRlciIsInNsaWNlIiwiZGlzcGxheUJhciIsInJhbmdlTWluIiwicmFuZ2VNYXgiLCJzdHlsZUNsYXNzIiwic2hvd1RleHQiLCJwZXJjZW50YWdlIiwiZGFuZ2VyVG9DbGFzcyIsImxldmVsIiwiZGFuZ2VyVG9TcGFuIiwiZGlzcGxheUROQUJsb2NrcyIsImRuYVN0cmluZyIsInNlbGVjdGVkQmxvY2siLCJzZWxlY3RlZFN1YmJsb2NrIiwiYmxvY2tTaXplIiwicGFyYW1LZXkiLCJjaGFyYWN0ZXJzIiwiYmxvY2siLCJzdWJibG9jayIsInNlbGVjdFVJQmxvY2siLCJzZWxlY3RVSVN1YmJsb2NrIiwic2VsZWN0U0VCbG9jayIsInNlbGVjdFNFU3ViYmxvY2siLCJjTWlycm9yIiwidGV4dGJveCIsIkNvZGVNaXJyb3IiLCJmcm9tVGV4dEFyZWEiLCJnZXRFbGVtZW50QnlJZCIsImxpbmVOdW1iZXJzIiwiaW5kZW50VW5pdCIsImluZGVudFdpdGhUYWJzIiwidGhlbWUiLCJzbW9vdGhOdW1iZXIiLCJzbW9vdGhSb3VuZCIsInVuZGVmaW5lZCIsInBsYWNlZCIsInRvRml4ZWQiLCJhZGRIZWxwZXJzIiwicmVtb3ZlSGVscGVycyIsImhlbHBlcktleSIsInJlbW92ZUhlbHBlciIsIk5hbm9TdGF0ZURlZmF1bHRDbGFzcyIsIk5hbm9TdGF0ZURlZmF1bHQiLCJOYW5vU3RhdGVQREFDbGFzcyIsIk5hbm9TdGF0ZVBEQSIsImN1cnJlbnRfdGVtcGxhdGUiLCJ0ZW1wbGF0ZSIsIndoZW4iLCJhamF4IiwiZGF0YVR5cGUiLCJkb25lIiwidGVtcGxhdGVNYXJrdXAiLCJhZGRUZW1wbGF0ZSIsInJlc2V0VGVtcGxhdGUiLCJwYXJzZSIsImZhaWwiLCJ0ZW1wbGF0ZUV4aXN0cyIsImxheW91dFJlbmRlcmVkIiwiY29udGVudFJlbmRlcmVkIiwibWFwSW5pdGlhbGlzZWQiLCJpc0N1cnJlbnQiLCJuZXh0U3RhdGUiLCJkcmFnZ2FibGUiLCJhbGVydFRleHQiLCJfdGVtcGxhdGVEYXRhIiwiX3RlbXBsYXRlcyIsIl9jb21waWxlZFRlbXBsYXRlcyIsIl9oZWxwZXJzIiwibG9hZE5leHRUZW1wbGF0ZSIsInRyaWdnZXIiLCJ0ZW1wbGF0ZVN0cmluZyIsInRlbXBsYXRlS2V5IiwiY29tcGlsZVRlbXBsYXRlcyIsImFkZEhlbHBlciIsImhlbHBlck5hbWUiLCJoZWxwZXJGdW5jdGlvbiIsImhlbHBlcnMiLCJpZENhY2hlIiwic3RhdGVDYWNoZSIsImN1cnJlbnRJRCIsIl91cGRhdGVFbGVtZW50IiwiaWQiLCJuZXdTdGF0ZSIsIm1lcmdlIiwib2xkU3RhdGUiLCJlbGVtZW50IiwidGFnTmFtZSIsInRhYkluZGV4IiwicGFyZW50Tm9kZSIsIm5ld1N0YXRlQ29weSIsImsiLCJfcmVzb2x2ZVRhcmdldCIsImZpbHRlciIsIl9hbmltYXRlRWxlbWVudCIsInRpbWUiLCJ0YXJnZXQiLCJhbmltYXRlIiwiZHVyYXRpb24iLCJxdWV1ZSIsIm9sZENsYXNzIiwibmV3Q2xhc3MiLCJmaWx0ZXJlZE9sZENsYXNzIiwiZmlsdGVyZWROZXdDbGFzcyIsInN3aXRjaENsYXNzIiwidW5pcXVlSUQiLCJ1cGRhdGVFbGVtZW50IiwiYW5pbWF0ZUVsZW1lbnQiLCJhbmltYXRlVGV4dFZhbHVlIiwib2xkVmFsdWUiLCJuZXdWYWx1ZSIsInN0ZXAiLCJub3ciLCJmeCIsImVsZW0iLCJ0ZXh0Q29udGVudCIsImFuaW1hdGVIb3ZlciIsImhvdmVyIiwic3RvcCIsIi4uaG92ZXIiLCJ0cmFuc2l0aW9uRWxlbWVudCIsIm9sZCIsIm9mZnNldFgiLCJvZmZzZXRZIiwiZHJhZ2dpbmciLCJsYXN0WCIsImxhc3RZIiwicmVzaXppbmciLCJyZXNpemVXb3JraW5nIiwic2V0UG9zIiwieSIsInNldFNpemUiLCJ3IiwiaCIsIm9iZXlMaW1pdHMiLCJwcmV2WCIsInNjcmVlbkxlZnQiLCJwcmV2WSIsInNjcmVlblRvcCIsImNsYW1wZWRYIiwiY2xhbXBlZFkiLCJuZXdXaWR0aCIsIm1heCIsIm5ld0hlaWdodCIsImZhbmN5Q2hyb21lIiwiYXR0YWNoQnV0dG9ucyIsImF0dGFjaERyYWdBbmRSZXNpemUiLCJldiIsImRyYWciLCJzZXRDYXB0dXJlIiwicmVsZWFzZUNhcHR1cmUiLCJyZXNpemUiLCJzY3JlZW5YIiwic2NyZWVuWSIsImNsaWVudFkiLCJkeCIsImR5IiwicngiLCJyeSIsIm5ld1giLCJuZXdZIiwibmV3VyIsIm5ld0giLCJ1c2VyIiwiZmFuY3kiXSwibWFwcGluZ3MiOiJBQUNBLElBQUlBLFlBQWMsV0FDZCxJQUFJQyxFQUFpQixHQUVyQixNQUFPLENBQ0hDLEtBQU0sV0FDRixJQUFJQyxFQUFPQyxFQUFFLFFBQ2JILEVBQWlCRSxFQUFLRSxLQUFL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QkMsRUFBT3ZULEtBQUttUyxJQTdMSixJQTZMbUJvQixHQUMzQmpDLEVBQU84QixFQUFNQyxHQUNiN0IsRUFBUThCLEVBQU1DLEdBR2xCckMsRUFBUXNCLEVBQUdLLFFBQVU5QixFQUNyQkksRUFBUXFCLEVBQUdNLFFBQVU5QixFQUVyQkssR0FBZ0IsSUFJcEIsTUFBTyxDQUNINVUsS0FBTSxXQUNGRSxFQUFFeUMsVUFBVWlFLEdBQUcsa0JBQW1CLFdBN0p0Q3NPLElBRUlwVSxpQkFBaUJDLFVBQVVDLE9BQU8rVixLQUFLQyxRQUkzQ3BCLElBR0FWLElBRUFXLElBQ0FDLFNBOURTIiwiZmlsZSI6Im5hbm8uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBOYW5vVXRpbGl0eSBpcyB0aGUgcGxhY2UgdG8gc3RvcmUgdXRpbGl0eSBmdW5jdGlvbnNcclxudmFyIE5hbm9VdGlsaXR5ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIF91cmxQYXJhbWV0ZXJzID0ge307IC8vIFRoaXMgaXMgcG9wdWxhdGVkIHdpdGggdGhlIGJhc2UgdXJsIHBhcmFtZXRlcnMgKHVzZWQgYnkgYWxsIGxpbmtzKSwgd2hpY2ggaXMgcHJvYmFieSBqdXN0IHRoZSBcInNyY1wiIHBhcmFtZXRlclxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgYm9keSA9ICQoJ2JvZHknKTsgLy8gV2Ugc3RvcmUgZGF0YSBpbiB0aGUgYm9keSB0YWcsIGl0J3MgYXMgZ29vZCBhIHBsYWNlIGFzIGFueVxyXG4gICAgICAgICAgICBfdXJsUGFyYW1ldGVycyA9IGJvZHkuZGF0YSgndXJsUGFyYW1ldGVycycpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLy8gZ2VuZXJhdGUgYSBCeW9uZCBocmVmLCBjb21iaW5lcyBfdXJsUGFyYW1ldGVycyB3aXRoIHBhcmFtZXRlcnNcclxuICAgICAgICBnZW5lcmF0ZUhyZWY6IGZ1bmN0aW9uIChwYXJhbWV0ZXJzKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeVN0cmluZyA9ICc/JztcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBfdXJsUGFyYW1ldGVycykge1xyXG4gICAgICAgICAgICAgICAgaWYgKF91cmxQYXJhbWV0ZXJzLmhhc093blByb3BlcnR5KGtleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocXVlcnlTdHJpbmcgIT09ICc/Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBxdWVyeVN0cmluZyArPSAnOyc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nICs9IGtleSArICc9JyArIF91cmxQYXJhbWV0ZXJzW2tleV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwYXJhbWV0ZXJzKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZiAocGFyYW1ldGVycy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHF1ZXJ5U3RyaW5nICE9PSAnPycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlTdHJpbmcgKz0gJzsnO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBxdWVyeVN0cmluZyArPSBrZXkgKyAnPScgKyBwYXJhbWV0ZXJzW2tleV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHF1ZXJ5U3RyaW5nO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgd2luc2V0OiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgd2luZG93KSB7XHJcbiAgICAgICAgICAgIHZhciBvYmosIHBhcmFtcywgd2luc2V0UmVmO1xyXG4gICAgICAgICAgICBpZiAod2luZG93ID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdyA9IE5hbm9TdGF0ZU1hbmFnZXIuZ2V0RGF0YSgpLmNvbmZpZy53aW5kb3cucmVmO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmFtcyA9IChcclxuICAgICAgICAgICAgICAgIG9iaiA9IHt9LFxyXG4gICAgICAgICAgICAgICAgb2JqW3dpbmRvdyArIFwiLlwiICsga2V5XSA9IHZhbHVlLFxyXG4gICAgICAgICAgICAgICAgb2JqXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHJldHVybiBsb2NhdGlvbi5ocmVmID0gTmFub1V0aWxpdHkuaHJlZihcIndpbnNldFwiLCBwYXJhbXMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXh0ZW5kOiBmdW5jdGlvbihmaXJzdCwgc2Vjb25kKSB7XHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHNlY29uZCkuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzZWNvbmRWYWw7XHJcbiAgICAgICAgICAgICAgICBzZWNvbmRWYWwgPSBzZWNvbmRba2V5XTtcclxuICAgICAgICAgICAgICAgIGlmIChzZWNvbmRWYWwgJiYgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHNlY29uZFZhbCkgPT09IFwiW29iamVjdCBPYmplY3RdXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBmaXJzdFtrZXldID0gZmlyc3Rba2V5XSB8fCB7fTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTmFub1V0aWxpdHkuZXh0ZW5kKGZpcnN0W2tleV0sIHNlY29uZFZhbCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmaXJzdFtrZXldID0gc2Vjb25kVmFsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIGZpcnN0O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgaHJlZjogZnVuY3Rpb24odXJsLCBwYXJhbXMpIHtcclxuICAgICAgICAgICAgaWYgKHVybCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB1cmwgPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwYXJhbXMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zID0ge307XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdXJsID0gbmV3IFVybChcImJ5b25kOi8vXCIgKyB1cmwpO1xyXG4gICAgICAgICAgICBOYW5vVXRpbGl0eS5leHRlbmQodXJsLnF1ZXJ5LCBwYXJhbXMpO1xyXG4gICAgICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY2xvc2U6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcGFyYW1zO1xyXG4gICAgICAgICAgICBwYXJhbXMgPSB7XHJcbiAgICAgICAgICAgICAgICBjb21tYW5kOiBcIm5hbm9jbG9zZSBcIiArIF91cmxQYXJhbWV0ZXJzLnNyY1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB0aGlzLndpbnNldChcImlzLXZpc2libGVcIiwgXCJmYWxzZVwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIGxvY2F0aW9uLmhyZWYgPSBOYW5vVXRpbGl0eS5ocmVmKFwid2luc2V0XCIsIHBhcmFtcyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59ICgpO1xyXG5cclxuaWYgKHR5cGVvZiBqUXVlcnkgPT0gJ3VuZGVmaW5lZCcpIHsgIFxyXG4gICAgcmVwb3J0RXJyb3IoJ0VSUk9SOiBKYXZhc2NyaXB0IGxpYnJhcnkgZmFpbGVkIHRvIGxvYWQhJyk7XHJcbn1cclxuaWYgKHR5cGVvZiBkb1QgPT0gJ3VuZGVmaW5lZCcpIHsgIFxyXG4gICAgcmVwb3J0RXJyb3IoJ0VSUk9SOiBUZW1wbGF0ZSBlbmdpbmUgZmFpbGVkIHRvIGxvYWQhJyk7XHJcbn1cclxuXHJcbnZhciByZXBvcnRFcnJvciA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIHdpbmRvdy5sb2NhdGlvbiA9IFwiYnlvbmQ6Ly8/bmFub19lcnI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoc3RyKTtcclxuICAgIGFsZXJ0KHN0cik7XHJcbn1cclxuXHJcbi8vIEFsbCBzY3JpcHRzIGFyZSBpbml0aWFsaXNlZCBoZXJlLCB0aGlzIGFsbG93cyBjb250cm9sIG9mIGluaXQgb3JkZXJcclxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG4gICAgTmFub1V0aWxpdHkuaW5pdCgpO1xyXG4gICAgTmFub1N0YXRlTWFuYWdlci5pbml0KCk7XHJcbiAgICBOYW5vVGVtcGxhdGUuaW5pdCgpO1xyXG4gICAgTmFub1dpbmRvdy5pbml0KCk7XHJcbn0pO1xyXG5cclxuaWYgKCFBcnJheS5wcm90b3R5cGUuaW5kZXhPZilcclxue1xyXG4gICAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbihlbHQgLyosIGZyb20qLylcclxuICAgIHtcclxuICAgICAgICB2YXIgbGVuID0gdGhpcy5sZW5ndGg7XHJcblxyXG4gICAgICAgIHZhciBmcm9tID0gTnVtYmVyKGFyZ3VtZW50c1sxXSkgfHwgMDtcclxuICAgICAgICBmcm9tID0gKGZyb20gPCAwKVxyXG4gICAgICAgICAgICA/IE1hdGguY2VpbChmcm9tKVxyXG4gICAgICAgICAgICA6IE1hdGguZmxvb3IoZnJvbSk7XHJcbiAgICAgICAgaWYgKGZyb20gPCAwKVxyXG4gICAgICAgICAgICBmcm9tICs9IGxlbjtcclxuXHJcbiAgICAgICAgZm9yICg7IGZyb20gPCBsZW47IGZyb20rKylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmIChmcm9tIGluIHRoaXMgJiZcclxuICAgICAgICAgICAgICAgIHRoaXNbZnJvbV0gPT09IGVsdClcclxuICAgICAgICAgICAgICAgIHJldHVybiBmcm9tO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gLTE7XHJcbiAgICB9O1xyXG59O1xyXG5cclxuaWYgKCFTdHJpbmcucHJvdG90eXBlLmZvcm1hdClcclxue1xyXG4gICAgU3RyaW5nLnByb3RvdHlwZS5mb3JtYXQgPSBmdW5jdGlvbiAoYXJncykge1xyXG4gICAgICAgIHZhciBzdHIgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBzdHIucmVwbGFjZShTdHJpbmcucHJvdG90eXBlLmZvcm1hdC5yZWdleCwgZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgICAgICB2YXIgaW50VmFsID0gcGFyc2VJbnQoaXRlbS5zdWJzdHJpbmcoMSwgaXRlbS5sZW5ndGggLSAxKSk7XHJcbiAgICAgICAgICAgIHZhciByZXBsYWNlO1xyXG4gICAgICAgICAgICBpZiAoaW50VmFsID49IDApIHtcclxuICAgICAgICAgICAgICAgIHJlcGxhY2UgPSBhcmdzW2ludFZhbF07XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW50VmFsID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgcmVwbGFjZSA9IFwie1wiO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGludFZhbCA9PT0gLTIpIHtcclxuICAgICAgICAgICAgICAgIHJlcGxhY2UgPSBcIn1cIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJlcGxhY2UgPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXBsYWNlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFN0cmluZy5wcm90b3R5cGUuZm9ybWF0LnJlZ2V4ID0gbmV3IFJlZ0V4cChcInstP1swLTldK31cIiwgXCJnXCIpO1xyXG59O1xyXG5cclxuT2JqZWN0LnNpemUgPSBmdW5jdGlvbihvYmopIHtcclxuICAgIHZhciBzaXplID0gMCwga2V5O1xyXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xyXG4gICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkgc2l6ZSsrO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHNpemU7XHJcbn07XHJcblxyXG5pZighd2luZG93LmNvbnNvbGUpIHtcclxuICAgIHdpbmRvdy5jb25zb2xlID0ge1xyXG4gICAgICAgIGxvZyA6IGZ1bmN0aW9uKHN0cikge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufTtcclxuXHJcblN0cmluZy5wcm90b3R5cGUudG9UaXRsZUNhc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc21hbGxXb3JkcyA9IC9eKGF8YW58YW5kfGFzfGF0fGJ1dHxieXxlbnxmb3J8aWZ8aW58b2Z8b258b3J8dGhlfHRvfHZzP1xcLj98dmlhKSQvaTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC8oW15cXFdfXStbXlxccy1dKikgKi9nLCBmdW5jdGlvbiAobWF0Y2gsIHAxLCBpbmRleCwgdGl0bGUpIHtcclxuICAgICAgICBpZiAoaW5kZXggPiAwICYmIGluZGV4ICsgcDEubGVuZ3RoICE9PSB0aXRsZS5sZW5ndGggJiZcclxuICAgICAgICAgICAgcDEuc2VhcmNoKHNtYWxsV29yZHMpID4gLTEgJiYgdGl0bGUuY2hhckF0KGluZGV4IC0gMikgIT09IFwiOlwiICYmXHJcbiAgICAgICAgICAgIHRpdGxlLmNoYXJBdChpbmRleCAtIDEpLnNlYXJjaCgvW15cXHMtXS8pIDwgMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbWF0Y2gudG9Mb3dlckNhc2UoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChwMS5zdWJzdHIoMSkuc2VhcmNoKC9bQS1aXXxcXC4uLykgPiAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbWF0Y2g7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbWF0Y2guY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBtYXRjaC5zdWJzdHIoMSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbiQuYWpheFNldHVwKHtcclxuICAgIGNhY2hlOiBmYWxzZVxyXG59KTtcclxuXHJcbkZ1bmN0aW9uLnByb3RvdHlwZS5pbmhlcml0c0Zyb20gPSBmdW5jdGlvbiAocGFyZW50Q2xhc3NPck9iamVjdCkge1xyXG4gICAgdGhpcy5wcm90b3R5cGUgPSBuZXcgcGFyZW50Q2xhc3NPck9iamVjdDtcclxuICAgIHRoaXMucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gdGhpcztcclxuICAgIHRoaXMucHJvdG90eXBlLnBhcmVudCA9IHBhcmVudENsYXNzT3JPYmplY3QucHJvdG90eXBlO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbn07XHJcblxyXG5pZiAoIVN0cmluZy5wcm90b3R5cGUudHJpbSkge1xyXG4gICAgU3RyaW5nLnByb3RvdHlwZS50cmltID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKTtcclxuICAgIH07XHJcbn1cclxuXHJcbi8vIFJlcGxpY2F0ZSB0aGUgY2tleSBwcm9jIGZyb20gQllPTkRcclxuaWYgKCFTdHJpbmcucHJvdG90eXBlLmNrZXkpIHtcclxuICAgIFN0cmluZy5wcm90b3R5cGUuY2tleSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC9cXFcvZywgJycpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICB9O1xyXG59XG4vLyBOYW5vU3RhdGVNYW5hZ2VyIGhhbmRsZXMgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIgYW5kIHVzZXMgaXQgdG8gcmVuZGVyIHRlbXBsYXRlc1xyXG5OYW5vU3RhdGVNYW5hZ2VyID0gZnVuY3Rpb24gKCkgXHJcbntcclxuICAgIC8vIF9pc0luaXRpYWxpc2VkIGlzIHNldCB0byB0cnVlIHdoZW4gYWxsIG9mIHRoaXMgdWkncyB0ZW1wbGF0ZXMgaGF2ZSBiZWVuIHByb2Nlc3NlZC9yZW5kZXJlZFxyXG4gICAgdmFyIF9pc0luaXRpYWxpc2VkID0gZmFsc2U7XHJcbiAgICAvLyB0aGUgZGF0YSBmb3IgdGhpcyB1aVxyXG4gICAgdmFyIF9kYXRhID0gbnVsbDtcclxuXHJcbiAgICAvLyB0aGlzIGlzIGFuIGFycmF5IG9mIGNhbGxiYWNrcyB3aGljaCBhcmUgY2FsbGVkIHdoZW4gbmV3IGRhdGEgYXJyaXZlcywgYmVmb3JlIGl0IGlzIHByb2Nlc3NlZFxyXG4gICAgdmFyIF9iZWZvcmVVcGRhdGVDYWxsYmFja3MgPSB7fTtcclxuICAgIC8vIHRoaXMgaXMgYW4gYXJyYXkgb2YgY2FsbGJhY2tzIHdoaWNoIGFyZSBjYWxsZWQgd2hlbiBuZXcgZGF0YSBhcnJpdmVzLCBiZWZvcmUgaXQgaXMgcHJvY2Vzc2VkXHJcbiAgICB2YXIgX2FmdGVyVXBkYXRlQ2FsbGJhY2tzID0ge307XHJcbiAgICBcclxuICAgIC8vIHRoaXMgaXMgYW4gYXJyYXkgb2Ygc3RhdGUgb2JqZWN0cywgdGhlc2UgY2FuIGJlIHVzZWQgdG8gcHJvdmlkZSBjdXN0b20gamF2YXNjcmlwdCBsb2dpY1xyXG4gICAgdmFyIF9zdGF0ZXMgPSB7fTtcclxuICAgIHZhciBfY3VycmVudFN0YXRlID0gbnVsbDtcclxuICAgIFxyXG4gICAgLy8gdGhlIGluaXQgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4gdGhlIHVpIGhhcyBsb2FkZWRcclxuICAgIC8vIHRoaXMgZnVuY3Rpb24gc2V0cyB1cCB0aGUgdGVtcGxhdGVzIGFuZCBiYXNlIGZ1bmN0aW9uYWxpdHlcclxuICAgIHZhciBpbml0ID0gZnVuY3Rpb24gKCkgXHJcbiAgICB7XHJcbiAgICAgICAgLy8gV2Ugc3RvcmUgaW5pdGlhbERhdGEgYW5kIHRlbXBsYXRlRGF0YSBpbiB0aGUgYm9keSB0YWcsIGl0J3MgYXMgZ29vZCBhIHBsYWNlIGFzIGFueVxyXG4gICAgICAgIF9kYXRhID0gJCgnYm9keScpLmRhdGEoJ2luaXRpYWxEYXRhJyk7ICBcclxuICAgICAgICBcclxuICAgICAgICBpZiAoX2RhdGEgPT0gbnVsbCB8fCAhX2RhdGEuaGFzT3duUHJvcGVydHkoJ2NvbmZpZycpIHx8ICFfZGF0YS5oYXNPd25Qcm9wZXJ0eSgnZGF0YScpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmVwb3J0RXJyb3IoJ0Vycm9yOiBJbml0aWFsIGRhdGEgZGlkIG5vdCBsb2FkIGNvcnJlY3RseS4nICsgSlNPTi5zdHJpbmdpZnkoX2RhdGEpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBzdGF0ZUtleSA9ICdkZWZhdWx0JztcclxuICAgICAgICBpZiAoX2RhdGFbJ2NvbmZpZyddLmhhc093blByb3BlcnR5KCdzdGF0ZUtleScpICYmIF9kYXRhWydjb25maWcnXVsnc3RhdGVLZXknXSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHN0YXRlS2V5ID0gX2RhdGFbJ2NvbmZpZyddWydzdGF0ZUtleSddLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBOYW5vU3RhdGVNYW5hZ2VyLnNldEN1cnJlbnRTdGF0ZShzdGF0ZUtleSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgJChkb2N1bWVudCkub24oJ3RlbXBsYXRlc0xvYWRlZCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZG9VcGRhdGUoX2RhdGEpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgX2lzSW5pdGlhbGlzZWQgPSB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgLy8gUmVjZWl2ZSB1cGRhdGUgZGF0YSBmcm9tIHRoZSBzZXJ2ZXJcclxuICAgIHZhciByZWNlaXZlVXBkYXRlRGF0YSA9IGZ1bmN0aW9uIChqc29uU3RyaW5nKVxyXG4gICAge1xyXG4gICAgICAgIHZhciB1cGRhdGVEYXRhO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHJlcG9ydEVycm9yKFwicmVjaWV2ZVVwZGF0ZURhdGEgY2FsbGVkLlwiICsgXCI8YnI+VHlwZTogXCIgKyB0eXBlb2YganNvblN0cmluZyk7IC8vZGVidWcgaG9va1xyXG4gICAgICAgIHRyeVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgLy8gcGFyc2UgdGhlIEpTT04gc3RyaW5nIGZyb20gdGhlIHNlcnZlciBpbnRvIGEgSlNPTiBvYmplY3RcclxuICAgICAgICAgICAgdXBkYXRlRGF0YSA9IGpRdWVyeS5wYXJzZUpTT04oanNvblN0cmluZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlcnJvcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJlcG9ydEVycm9yKFwicmVjaWV2ZVVwZGF0ZURhdGEgZmFpbGVkLiBcIiArIFwiPGJyPkVycm9yIG5hbWU6IFwiICsgZXJyb3IubmFtZSArIFwiPGJyPkVycm9yIE1lc3NhZ2U6IFwiICsgZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHJlcG9ydEVycm9yKFwicmVjaWV2ZVVwZGF0ZURhdGEgcGFzc2VkIHRyeWNhdGNoIGJsb2NrLlwiKTsgLy9kZWJ1ZyBob29rXHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCF1cGRhdGVEYXRhLmhhc093blByb3BlcnR5KCdkYXRhJykpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZiAoX2RhdGEgJiYgX2RhdGEuaGFzT3duUHJvcGVydHkoJ2RhdGEnKSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlRGF0YVsnZGF0YSddID0gX2RhdGFbJ2RhdGEnXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZURhdGFbJ2RhdGEnXSA9IHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChfaXNJbml0aWFsaXNlZCkgLy8gYWxsIHRlbXBsYXRlcyBoYXZlIGJlZW4gcmVnaXN0ZXJlZCwgc28gcmVuZGVyIHRoZW1cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGRvVXBkYXRlKHVwZGF0ZURhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBfZGF0YSA9IHVwZGF0ZURhdGE7IC8vIGFsbCB0ZW1wbGF0ZXMgaGF2ZSBub3QgYmVlbiByZWdpc3RlcmVkLiBXZSBzZXQgX2RhdGEgZGlyZWN0bHkgaGVyZSB3aGljaCB3aWxsIGJlIGFwcGxpZWQgYWZ0ZXIgdGhlIHRlbXBsYXRlIGlzIGxvYWRlZCB3aXRoIHRoZSBpbml0aWFsIGRhdGFcclxuICAgICAgICB9ICAgXHJcbiAgICB9O1xyXG5cclxuICAgIC8vIFRoaXMgZnVuY3Rpb24gZG9lcyB0aGUgdXBkYXRlIGJ5IGNhbGxpbmcgdGhlIG1ldGhvZHMgb24gdGhlIGN1cnJlbnQgc3RhdGVcclxuICAgIHZhciBkb1VwZGF0ZSA9IGZ1bmN0aW9uIChkYXRhKVxyXG4gICAge1xyXG4gICAgICAgIGlmIChfY3VycmVudFN0YXRlID09IG51bGwpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkYXRhID0gX2N1cnJlbnRTdGF0ZS5vbkJlZm9yZVVwZGF0ZShkYXRhKTtcclxuXHJcbiAgICAgICAgaWYgKGRhdGEgPT09IGZhbHNlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmVwb3J0RXJyb3IoJ2RhdGEgaXMgZmFsc2UsIHJldHVybicpO1xyXG4gICAgICAgICAgICByZXR1cm47IC8vIEEgYmVmb3JlVXBkYXRlQ2FsbGJhY2sgcmV0dXJuZWQgYSBmYWxzZSB2YWx1ZSwgdGhpcyBwcmV2ZW50cyB0aGUgcmVuZGVyIGZyb20gb2NjdXJpbmdcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgX2RhdGEgPSBkYXRhO1xyXG5cclxuICAgICAgICBfY3VycmVudFN0YXRlLm9uVXBkYXRlKF9kYXRhKTtcclxuXHJcbiAgICAgICAgX2N1cnJlbnRTdGF0ZS5vbkFmdGVyVXBkYXRlKF9kYXRhKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIC8vIEV4ZWN1dGUgYWxsIGNhbGxiYWNrcyBpbiB0aGUgY2FsbGJhY2tzIGFycmF5L29iamVjdCBwcm92aWRlZCwgdXBkYXRlRGF0YSBpcyBwYXNzZWQgdG8gdGhlbSBmb3IgcHJvY2Vzc2luZyBhbmQgcG90ZW50aWFsIG1vZGlmaWNhdGlvblxyXG4gICAgdmFyIGV4ZWN1dGVDYWxsYmFja3MgPSBmdW5jdGlvbiAoY2FsbGJhY2tzLCBkYXRhKVxyXG4gICAgeyAgIFxyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBjYWxsYmFja3MpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2tzLmhhc093blByb3BlcnR5KGtleSkgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oY2FsbGJhY2tzW2tleV0pKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBkYXRhID0gY2FsbGJhY2tzW2tleV0uY2FsbCh0aGlzLCBkYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSBcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlY2VpdmVVcGRhdGVEYXRhOiBmdW5jdGlvbiAoanNvblN0cmluZykgXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZWNlaXZlVXBkYXRlRGF0YShqc29uU3RyaW5nKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFkZEJlZm9yZVVwZGF0ZUNhbGxiYWNrOiBmdW5jdGlvbiAoa2V5LCBjYWxsYmFja0Z1bmN0aW9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgX2JlZm9yZVVwZGF0ZUNhbGxiYWNrc1trZXldID0gY2FsbGJhY2tGdW5jdGlvbjtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFkZEJlZm9yZVVwZGF0ZUNhbGxiYWNrczogZnVuY3Rpb24gKGNhbGxiYWNrcykgeyAgICAgICAgXHJcbiAgICAgICAgICAgIGZvciAodmFyIGNhbGxiYWNrS2V5IGluIGNhbGxiYWNrcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjYWxsYmFja3MuaGFzT3duUHJvcGVydHkoY2FsbGJhY2tLZXkpKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgTmFub1N0YXRlTWFuYWdlci5hZGRCZWZvcmVVcGRhdGVDYWxsYmFjayhjYWxsYmFja0tleSwgY2FsbGJhY2tzW2NhbGxiYWNrS2V5XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlbW92ZUJlZm9yZVVwZGF0ZUNhbGxiYWNrOiBmdW5jdGlvbiAoa2V5KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYgKF9iZWZvcmVVcGRhdGVDYWxsYmFja3MuaGFzT3duUHJvcGVydHkoa2V5KSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIF9iZWZvcmVVcGRhdGVDYWxsYmFja3Nba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXhlY3V0ZUJlZm9yZVVwZGF0ZUNhbGxiYWNrczogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGV4ZWN1dGVDYWxsYmFja3MoX2JlZm9yZVVwZGF0ZUNhbGxiYWNrcywgZGF0YSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBhZGRBZnRlclVwZGF0ZUNhbGxiYWNrOiBmdW5jdGlvbiAoa2V5LCBjYWxsYmFja0Z1bmN0aW9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgX2FmdGVyVXBkYXRlQ2FsbGJhY2tzW2tleV0gPSBjYWxsYmFja0Z1bmN0aW9uO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYWRkQWZ0ZXJVcGRhdGVDYWxsYmFja3M6IGZ1bmN0aW9uIChjYWxsYmFja3MpIHsgICAgIFxyXG4gICAgICAgICAgICBmb3IgKHZhciBjYWxsYmFja0tleSBpbiBjYWxsYmFja3MpIHtcclxuICAgICAgICAgICAgICAgIGlmICghY2FsbGJhY2tzLmhhc093blByb3BlcnR5KGNhbGxiYWNrS2V5KSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIE5hbm9TdGF0ZU1hbmFnZXIuYWRkQWZ0ZXJVcGRhdGVDYWxsYmFjayhjYWxsYmFja0tleSwgY2FsbGJhY2tzW2NhbGxiYWNrS2V5XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlbW92ZUFmdGVyVXBkYXRlQ2FsbGJhY2s6IGZ1bmN0aW9uIChrZXkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZiAoX2FmdGVyVXBkYXRlQ2FsbGJhY2tzLmhhc093blByb3BlcnR5KGtleSkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSBfYWZ0ZXJVcGRhdGVDYWxsYmFja3Nba2V5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXhlY3V0ZUFmdGVyVXBkYXRlQ2FsbGJhY2tzOiBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZXhlY3V0ZUNhbGxiYWNrcyhfYWZ0ZXJVcGRhdGVDYWxsYmFja3MsIGRhdGEpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYWRkU3RhdGU6IGZ1bmN0aW9uIChzdGF0ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmICghKHN0YXRlIGluc3RhbmNlb2YgTmFub1N0YXRlQ2xhc3MpKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXBvcnRFcnJvcignRVJST1I6IEF0dGVtcHRlZCB0byBhZGQgYSBzdGF0ZSB3aGljaCBpcyBub3QgaW5zdGFuY2VvZiBOYW5vU3RhdGVDbGFzcycpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghc3RhdGUua2V5KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXBvcnRFcnJvcignRVJST1I6IEF0dGVtcHRlZCB0byBhZGQgYSBzdGF0ZSB3aXRoIGFuIGludmFsaWQgc3RhdGVLZXknKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBfc3RhdGVzW3N0YXRlLmtleV0gPSBzdGF0ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHNldEN1cnJlbnRTdGF0ZTogZnVuY3Rpb24gKHN0YXRlS2V5KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzdGF0ZUtleSA9PSAndW5kZWZpbmVkJyB8fCAhc3RhdGVLZXkpIHtcclxuICAgICAgICAgICAgICAgIHJlcG9ydEVycm9yKCdFUlJPUjogTm8gc3RhdGUga2V5IHdhcyBwYXNzZWQhJyk7ICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCFfc3RhdGVzLmhhc093blByb3BlcnR5KHN0YXRlS2V5KSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmVwb3J0RXJyb3IoJ0VSUk9SOiBBdHRlbXB0ZWQgdG8gc2V0IGEgY3VycmVudCBzdGF0ZSB3aGljaCBkb2VzIG5vdCBleGlzdDogJyArIHN0YXRlS2V5KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfSAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgcHJldmlvdXNTdGF0ZSA9IF9jdXJyZW50U3RhdGU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBfY3VycmVudFN0YXRlID0gX3N0YXRlc1tzdGF0ZUtleV07XHJcblxyXG4gICAgICAgICAgICBpZiAocHJldmlvdXNTdGF0ZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBwcmV2aW91c1N0YXRlLm9uUmVtb3ZlKF9jdXJyZW50U3RhdGUpO1xyXG4gICAgICAgICAgICB9ICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBfY3VycmVudFN0YXRlLm9uQWRkKHByZXZpb3VzU3RhdGUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXRDdXJyZW50U3RhdGU6IGZ1bmN0aW9uICgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gX2N1cnJlbnRTdGF0ZTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGdldERhdGE6IGZ1bmN0aW9uICgpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gX2RhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSAoKTtcclxuIFxuLy8gTmFub0Jhc2VDYWxsYmFja3MgaXMgd2hlcmUgdGhlIGJhc2UgY2FsbGJhY2tzIChjb21tb24gdG8gYWxsIHRlbXBsYXRlcykgYXJlIHN0b3JlZFxyXG5OYW5vQmFzZUNhbGxiYWNrcyA9IGZ1bmN0aW9uICgpXHJcbntcclxuICAgIC8vIF9jYW5DbGljayBpcyB1c2VkIHRvIGRpc2FibGUgY2xpY2tzIGZvciBhIHNob3J0IHBlcmlvZCBhZnRlciBlYWNoIGNsaWNrICh0byBhdm9pZCBtaXMtY2xpY2tzKVxyXG4gICAgdmFyIF9jYW5DbGljayA9IHRydWU7XHJcbiAgICB2YXIgX2Jhc2VCZWZvcmVVcGRhdGVDYWxsYmFja3MgPSB7fTtcclxuICAgIHZhciBfYmFzZUFmdGVyVXBkYXRlQ2FsbGJhY2tzID0ge1xyXG4gICAgICAgIC8vIHRoaXMgY2FsbGJhY2sgaXMgdHJpZ2dlcmVkIGFmdGVyIG5ldyBkYXRhIGlzIHByb2Nlc3NlZFxyXG4gICAgICAgIC8vIGl0IHVwZGF0ZXMgdGhlIHN0YXR1cy92aXNpYmlsaXR5IGljb24gYW5kIGFkZHMgY2xpY2sgZXZlbnQgaGFuZGxpbmcgdG8gYnV0dG9ucy9saW5rcyAgICAgXHJcbiAgICAgICAgc3RhdHVzOiBmdW5jdGlvbiAodXBkYXRlRGF0YSkge1xyXG4gICAgICAgICAgICB2YXIgdWlTdGF0dXNDbGFzcztcclxuICAgICAgICAgICAgaWYgKHVwZGF0ZURhdGFbJ2NvbmZpZyddWydzdGF0dXMnXSA9PSAyKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB1aVN0YXR1c0NsYXNzID0gJ2dvb2QnO1xyXG4gICAgICAgICAgICAgICAgJCgnLmxpbmtBY3RpdmUnKS5yZW1vdmVDbGFzcygnaW5hY3RpdmUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh1cGRhdGVEYXRhWydjb25maWcnXVsnc3RhdHVzJ10gPT0gMSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdWlTdGF0dXNDbGFzcyA9ICdhdmVyYWdlJztcclxuICAgICAgICAgICAgICAgICQoJy5saW5rQWN0aXZlJykuYWRkQ2xhc3MoJ2luYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB1aVN0YXR1c0NsYXNzID0gJ2JhZCc7XHJcbiAgICAgICAgICAgICAgICAkKCcubGlua0FjdGl2ZScpLmFkZENsYXNzKCdpbmFjdGl2ZScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICQoJy5zdGF0dXNpY29uJykucmVtb3ZlQ2xhc3MoXCJnb29kIGJhZCBhdmVyYWdlXCIpLmFkZENsYXNzKHVpU3RhdHVzQ2xhc3MpO1xyXG4gICAgICAgICAgICAkKCcubGlua0FjdGl2ZScpLnN0b3BUaW1lKCdsaW5rUGVuZGluZycpO1xyXG4gICAgICAgICAgICAkKCcubGlua0FjdGl2ZScpLnJlbW92ZUNsYXNzKCdsaW5rUGVuZGluZycpO1xyXG5cclxuICAgICAgICAgICAgJCgnLmxpbmtBY3RpdmUnKVxyXG4gICAgICAgICAgICAgICAgLm9mZignY2xpY2snKVxyXG4gICAgICAgICAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhyZWYgPSAkKHRoaXMpLmRhdGEoJ2hyZWYnKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihocmVmICE9IG51bGwgJiYgX2NhbkNsaWNrKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2NhbkNsaWNrID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJ2JvZHknKS5vbmVUaW1lKDMwMCwgJ2VuYWJsZUNsaWNrJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NhbkNsaWNrID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGVEYXRhWydjb25maWcnXVsnc3RhdHVzJ10gPT0gMilcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5vbmVUaW1lKDMwMCwgJ2xpbmtQZW5kaW5nJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ2xpbmtQZW5kaW5nJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGhyZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlRGF0YTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIG5hbm9tYXA6IGZ1bmN0aW9uICh1cGRhdGVEYXRhKSB7XHJcbiAgICAgICAgICAgICQoJy5tYXBJY29uJylcclxuICAgICAgICAgICAgICAgIC5vZmYoJ21vdXNlZW50ZXIgbW91c2VsZWF2ZScpXHJcbiAgICAgICAgICAgICAgICAub24oJ21vdXNlZW50ZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJyN1aU1hcFRvb2x0aXAnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmh0bWwoJCh0aGlzKS5jaGlsZHJlbignLnRvb2x0aXAnKS5odG1sKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc2hvdygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuc3RvcFRpbWUoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uZVRpbWUoNTAwMCwgJ2hpZGVUb29sdGlwJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuZmFkZU91dCg1MDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICQoJy56b29tTGluaycpXHJcbiAgICAgICAgICAgICAgICAub2ZmKCdjbGljaycpXHJcbiAgICAgICAgICAgICAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgem9vbUxldmVsID0gJCh0aGlzKS5kYXRhKCd6b29tTGV2ZWwnKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdWlNYXBPYmplY3QgPSAkKCcjdWlNYXAnKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdWlNYXBXaWR0aCA9IHVpTWFwT2JqZWN0LndpZHRoKCkgKiB6b29tTGV2ZWw7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVpTWFwSGVpZ2h0ID0gdWlNYXBPYmplY3QuaGVpZ2h0KCkgKiB6b29tTGV2ZWw7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHVpTWFwT2JqZWN0LmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHpvb206IHpvb21MZXZlbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJzUwJScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvcDogJzUwJScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbkxlZnQ6ICctJyArIE1hdGguZmxvb3IodWlNYXBXaWR0aCAvIDIpICsgJ3B4JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luVG9wOiAnLScgKyBNYXRoLmZsb29yKHVpTWFwSGVpZ2h0IC8gMikgKyAncHgnXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICQoJyN1aU1hcEltYWdlJykuYXR0cignc3JjJyx1cGRhdGVEYXRhWydjb25maWcnXVsnbWFwJ10gKyAnX25hbm9tYXBfeicgKyB1cGRhdGVEYXRhWydjb25maWcnXVsnbWFwWkxldmVsJ10gKyAnLnBuZycpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZURhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGFkZENhbGxiYWNrczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBOYW5vU3RhdGVNYW5hZ2VyLmFkZEJlZm9yZVVwZGF0ZUNhbGxiYWNrcyhfYmFzZUJlZm9yZVVwZGF0ZUNhbGxiYWNrcyk7XHJcbiAgICAgICAgICAgIE5hbm9TdGF0ZU1hbmFnZXIuYWRkQWZ0ZXJVcGRhdGVDYWxsYmFja3MoX2Jhc2VBZnRlclVwZGF0ZUNhbGxiYWNrcyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZW1vdmVDYWxsYmFja3M6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgY2FsbGJhY2tLZXkgaW4gX2Jhc2VCZWZvcmVVcGRhdGVDYWxsYmFja3MpIHtcclxuICAgICAgICAgICAgICAgIGlmIChfYmFzZUJlZm9yZVVwZGF0ZUNhbGxiYWNrcy5oYXNPd25Qcm9wZXJ0eShjYWxsYmFja0tleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBOYW5vU3RhdGVNYW5hZ2VyLnJlbW92ZUJlZm9yZVVwZGF0ZUNhbGxiYWNrKGNhbGxiYWNrS2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb3IgKHZhciBjYWxsYmFja0tleSBpbiBfYmFzZUFmdGVyVXBkYXRlQ2FsbGJhY2tzKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoX2Jhc2VBZnRlclVwZGF0ZUNhbGxiYWNrcy5oYXNPd25Qcm9wZXJ0eShjYWxsYmFja0tleSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBOYW5vU3RhdGVNYW5hZ2VyLnJlbW92ZUFmdGVyVXBkYXRlQ2FsbGJhY2soY2FsbGJhY2tLZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSgpO1xyXG5cbi8vIE5hbm9CYXNlSGVscGVycyBpcyB3aGVyZSB0aGUgYmFzZSB0ZW1wbGF0ZSBoZWxwZXJzIChjb21tb24gdG8gYWxsIHRlbXBsYXRlcykgYXJlIHN0b3JlZFxyXG5OYW5vQmFzZUhlbHBlcnMgPSBmdW5jdGlvbiAoKVxyXG57XHJcbiAgICB2YXIgX2Jhc2VIZWxwZXJzID0ge1xyXG4gICAgICAgICAgICAvLyBjaGFuZ2UgdWkgc3R5bGluZyB0byBcInN5bmRpY2F0ZSBtb2RlXCJcclxuICAgICAgICAgICAgc3luZGljYXRlTW9kZTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3luZGljYXRlU1ZHID0gXCJ1cmwoJ2RhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEQ5NGJXd2dkbVZ5YzJsdmJqMGlNUzR3SWlCbGJtTnZaR2x1WnowaVZWUkdMVGdpSUhOMFlXNWtZV3h2Ym1VOUltNXZJajgrRFFvOGMzWm5JSGh0Ykc1elBTSm9kSFJ3T2k4dmQzZDNMbmN6TG05eVp5OHlNREF3TDNOMlp5SWdkbVZ5YzJsdmJqMGlNUzR3SWlCMmFXVjNRbTk0UFNJd0lEQWdOREF3SURJd01DSWdiM0JoWTJsMGVUMGlMakkxSWo0TkNnazhjRzlzZVdkdmJpQndiMmx1ZEhNOUlqSTFNQ3d3SURFMU1Dd3dJREV3TUN3MU1DSStQQzl3YjJ4NVoyOXVQZzBLQ1R4d2IyeDVaMjl1SUhCdmFXNTBjejBpTVRBd0xEVXdJREUxTUN3eU5TQXlNREFzTmpVZ01qVXdMREUxTUNJK1BDOXdiMng1WjI5dVBnMEtDVHh3YjJ4NVoyOXVJSEJ2YVc1MGN6MGlNalV3TERFMU1DQXlNREFzT1RBZ01UQXdMREl3TUNJK1BDOXdiMng1WjI5dVBnMEtQQzl6ZG1jKycpXCI7XHJcbiAgICAgICAgICAgICAgICAkKCcubWFpbkJHJykuY3NzKFwiYmFja2dyb3VuZFwiLCBzeW5kaWNhdGVTVkcgKyBcIiBuby1yZXBlYXQgZml4ZWQgY2VudGVyLzcwJSA3MCUsIGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sICM4ZjE0MTQgMCUsICM0QjBBMEEgMTAwJSkgbm8tcmVwZWF0IGZpeGVkIGNlbnRlci8xMDAlIDEwMCU7XCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICQoJyN1aVRpdGxlRmx1ZmYnKS5jc3MoXCJiYWNrZ3JvdW5kLWltYWdlXCIsXCJ1cmwoJ3VpVGl0bGVGbHVmZi1TeW5kaWNhdGUucG5nJylcIik7XHJcbiAgICAgICAgICAgICAgICAkKCcjdWlUaXRsZUZsdWZmJykuY3NzKFwiYmFja2dyb3VuZC1wb3NpdGlvblwiLFwiNTAlIDUwJVwiKTtcclxuICAgICAgICAgICAgICAgICQoJyN1aVRpdGxlRmx1ZmYnKS5jc3MoXCJiYWNrZ3JvdW5kLXJlcGVhdFwiLCBcIm5vLXJlcGVhdFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBjb21iaW5lOiBmdW5jdGlvbiggYXJyMSwgYXJyMiApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhcnIxICYmIGFycjIgPyBhcnIxLmNvbmNhdChhcnIyKSA6IGFycjEgfHwgYXJyMjtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZHVtcDogZnVuY3Rpb24oIGFycjEgKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJyMSk7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvLyBHZW5lcmF0ZSBhIEJ5b25kIGxpbmtcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oIHRleHQsIGljb24sIHBhcmFtZXRlcnMsIHN0YXR1cywgZWxlbWVudENsYXNzLCBlbGVtZW50SWQgKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaWNvbkh0bWwgPSAnJztcclxuICAgICAgICAgICAgICAgIHZhciBpY29uQ2xhc3MgPSAnbm9JY29uJztcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgaWNvbiAhPSAndW5kZWZpbmVkJyAmJiBpY29uKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGljb25IdG1sID0gJzxkaXYgY2xhc3M9XCJ1aUxpbmtQZW5kaW5nSWNvblwiPjwvZGl2PjxpIGNsYXNzPVwiZmEgZmEtZncgZmEtJyArIGljb24gKyAnXCI+PC9pPic7XHJcbiAgICAgICAgICAgICAgICAgICAgaWNvbkNsYXNzID0gJ2hhc0ljb24nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgZWxlbWVudENsYXNzID09ICd1bmRlZmluZWQnIHx8ICFlbGVtZW50Q2xhc3MpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudENsYXNzID0gJ2xpbmsnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50SWRIdG1sID0gJyc7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGVsZW1lbnRJZCAhPSAndW5kZWZpbmVkJyAmJiBlbGVtZW50SWQpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudElkSHRtbCA9ICdpZD1cIicgKyBlbGVtZW50SWQgKyAnXCInO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHZhciB0aWQgPSBOYW5vVHJhbnNpdGlvbi5hbGxvY0lEKGVsZW1lbnRJZEh0bWwgKyBcIl9cIiArIHRleHQudG9TdHJpbmcoKS5yZXBsYWNlKC9bXmEtejAtOV9dL2dpLCBcIl9cIikgKyBcIl9cIiArIGljb24pO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc3RhdHVzICE9ICd1bmRlZmluZWQnICYmIHN0YXR1cylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxkaXYgdW5zZWxlY3RhYmxlPVwib25cIiBjbGFzcz1cImxpbmsgJyArIGljb25DbGFzcyArICcgJyArIHRpZCArICdcIiAnICsgZWxlbWVudElkSHRtbCArICc+JyArIGljb25IdG1sICsgdGV4dCArICc8L2Rpdj48c2NyaXB0PiQoZnVuY3Rpb24oKSB7IHZhciBuZXdTdGF0ZSA9IHtcIi4uY2xhc3NcIjogXCInICsgZWxlbWVudENsYXNzICsgJyAnICsgc3RhdHVzICsgJ1wifTsgdmFyIG9sZCA9IE5hbm9UcmFuc2l0aW9uLnRyYW5zaXRpb25FbGVtZW50KFwiJyArIHRpZCArICdcIiwgbnVsbCwgbmV3U3RhdGUsIDIwMCk7IE5hbm9UcmFuc2l0aW9uLmFuaW1hdGVIb3ZlcihcIicgKyB0aWQgKyAnXCIsIG51bGwsIG9sZCwgbmV3U3RhdGUpOyB9KTs8L3NjcmlwdD4nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiAnPGRpdiB1bnNlbGVjdGFibGU9XCJvblwiIGNsYXNzPVwibGlua0FjdGl2ZSAnICsgaWNvbkNsYXNzICsgJyAnICsgdGlkICsgJ1wiIGRhdGEtaHJlZj1cIicgKyBOYW5vVXRpbGl0eS5nZW5lcmF0ZUhyZWYocGFyYW1ldGVycykgKyAnXCIgJyArIGVsZW1lbnRJZEh0bWwgKyAnPicgKyBpY29uSHRtbCArIHRleHQgKyAnPC9kaXY+PHNjcmlwdD4kKGZ1bmN0aW9uKCkgeyB2YXIgbmV3U3RhdGUgPSB7XCIuLmNsYXNzXCI6IFwiJyArIGVsZW1lbnRDbGFzcyArICdcIn07IHZhciBvbGQgPSBOYW5vVHJhbnNpdGlvbi50cmFuc2l0aW9uRWxlbWVudChcIicgKyB0aWQgKyAnXCIsIG51bGwsIG5ld1N0YXRlLCAyMDApOyBOYW5vVHJhbnNpdGlvbi5hbmltYXRlSG92ZXIoXCInICsgdGlkICsgJ1wiLCBudWxsLCBvbGQsIG5ld1N0YXRlKTsgfSk7PC9zY3JpcHQ+JztcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIHhvcjogZnVuY3Rpb24gKG51bWJlcixiaXQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudW1iZXIgXiBiaXQ7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICBwcmVjaXNpb25Sb3VuZDogZnVuY3Rpb24gKHZhbHVlLCBwbGFjZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmKHBsYWNlcyA9PSAwKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aC5yb3VuZChudW1iZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIG11bHRpcGxpZXIgPSBNYXRoLnBvdygxMCwgcGxhY2VzKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAoTWF0aC5yb3VuZCh2YWx1ZSAqIG11bHRpcGxpZXIpIC8gbXVsdGlwbGllcik7XHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvLyBSb3VuZCBhIG51bWJlciB0byB0aGUgbmVhcmVzdCBpbnRlZ2VyXHJcbiAgICAgICAgICAgIHJvdW5kOiBmdW5jdGlvbihudW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKG51bWJlcik7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZpeGVkOiBmdW5jdGlvbihudW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLnJvdW5kKG51bWJlciAqIDEwKSAvIDEwO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAvLyBSb3VuZCBhIG51bWJlciBkb3duIHRvIGludGVnZXJcclxuICAgICAgICAgICAgZmxvb3I6IGZ1bmN0aW9uKG51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IobnVtYmVyKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgLy8gUm91bmQgYSBudW1iZXIgdXAgdG8gaW50ZWdlclxyXG4gICAgICAgICAgICBjZWlsOiBmdW5jdGlvbihudW1iZXIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmNlaWwobnVtYmVyKTtcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIC8vIEZvcm1hdCBhIHN0cmluZyAofnN0cmluZyhcIkhlbGxvIHswfSwgaG93IGFyZSB7MX0/XCIsICdNYXJ0aW4nLCAneW91JykgYmVjb21lcyBcIkhlbGxvIE1hcnRpbiwgaG93IGFyZSB5b3U/XCIpXHJcbiAgICAgICAgICAgIHN0cmluZzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAwKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJndW1lbnRzWzBdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJncyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmd1bWVudHNbMF0uZm9ybWF0KHN0cmluZ0FyZ3MpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmb3JtYXROdW1iZXI6IGZ1bmN0aW9uKHgpIHtcclxuICAgICAgICAgICAgICAgIC8vIEZyb20gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yOTAxMTAyL2hvdy10by1wcmludC1hLW51bWJlci13aXRoLWNvbW1hcy1hcy10aG91c2FuZHMtc2VwYXJhdG9ycy1pbi1qYXZhc2NyaXB0XHJcbiAgICAgICAgICAgICAgICB2YXIgcGFydHMgPSB4LnRvU3RyaW5nKCkuc3BsaXQoXCIuXCIpO1xyXG4gICAgICAgICAgICAgICAgcGFydHNbMF0gPSBwYXJ0c1swXS5yZXBsYWNlKC9cXEIoPz0oXFxkezN9KSsoPyFcXGQpKS9nLCBcIixcIik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFydHMuam9pbihcIi5cIik7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIC8vIENhcGl0YWxpemUgdGhlIGZpcnN0IGxldHRlciBvZiBhIHN0cmluZy4gRnJvbSBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEwMjYwNjkvY2FwaXRhbGl6ZS10aGUtZmlyc3QtbGV0dGVyLW9mLXN0cmluZy1pbi1qYXZhc2NyaXB0XHJcbiAgICAgICAgICAgIGNhcGl0YWxpemVGaXJzdExldHRlcjogZnVuY3Rpb24oIHN0cmluZyApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmcuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHJpbmcuc2xpY2UoMSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIC8vIERpc3BsYXkgYSBiYXIuIFVzZWQgdG8gc2hvdyBoZWFsdGgsIGNhcGFjaXR5LCBldGMuXHJcbiAgICAgICAgICAgIGRpc3BsYXlCYXI6IGZ1bmN0aW9uKCB2YWx1ZSwgcmFuZ2VNaW4sIHJhbmdlTWF4LCBzdHlsZUNsYXNzLCBzaG93VGV4dCApIHtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocmFuZ2VNaW4gPCByYW5nZU1heClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPCByYW5nZU1pbilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gcmFuZ2VNaW47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gcmFuZ2VNYXgpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHJhbmdlTWF4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPiByYW5nZU1pbilcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gcmFuZ2VNaW47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlIDwgcmFuZ2VNYXgpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHJhbmdlTWF4O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHN0eWxlQ2xhc3MgPT0gJ3VuZGVmaW5lZCcgfHwgIXN0eWxlQ2xhc3MpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVDbGFzcyA9ICcnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc2hvd1RleHQgPT0gJ3VuZGVmaW5lZCcgfHwgIXNob3dUZXh0KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHNob3dUZXh0ID0gJyc7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHBlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKCh2YWx1ZSAtIHJhbmdlTWluKSAvIChyYW5nZU1heCAtIHJhbmdlTWluKSAqIDEwMCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGlkID0gTmFub1RyYW5zaXRpb24uYWxsb2NJRChyYW5nZU1pbiArIFwiX1wiICsgcmFuZ2VNYXgpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiAnPGRpdiBjbGFzcz1cImRpc3BsYXlCYXIgJyArIHRpZCArICcgJyArIHN0eWxlQ2xhc3MgKyAnXCI+PGRpdiBjbGFzcz1cImRpc3BsYXlCYXJGaWxsXCI+PC9kaXY+PGRpdiBjbGFzcz1cImRpc3BsYXlCYXJUZXh0ICcgKyBzdHlsZUNsYXNzICsgJ1wiPicgKyBzaG93VGV4dCArICc8L2Rpdj48L2Rpdj48c2NyaXB0PiQoZnVuY3Rpb24oKSB7IE5hbm9UcmFuc2l0aW9uLnRyYW5zaXRpb25FbGVtZW50KFwiJyArIHRpZCArICdcIiwgXCIuZGlzcGxheUJhckZpbGxcIiwge3dpZHRoOiBcIicgKyBwZXJjZW50YWdlICsgJyVcIiwgXCIuLmNsYXNzXCI6IFwiJyArIHN0eWxlQ2xhc3MgKyAnXCJ9KTsgfSk7PC9zY3JpcHQ+JztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgLy8gQ29udmVydCBkYW5nZXIgbGV2ZWwgdG8gY2xhc3MgKGZvciB0aGUgYWlyIGFsYXJtKVxyXG4gICAgICAgICAgICBkYW5nZXJUb0NsYXNzOiBmdW5jdGlvbihsZXZlbCkge1xyXG4gICAgICAgICAgICAgICAgaWYobGV2ZWwgPT0gMCkgcmV0dXJuICdnb29kJztcclxuICAgICAgICAgICAgICAgIGlmKGxldmVsID09IDEpIHJldHVybiAnYXZlcmFnZSc7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ2JhZCc7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGRhbmdlclRvU3BhbjogZnVuY3Rpb24obGV2ZWwpIHtcclxuICAgICAgICAgICAgICAgIGlmKGxldmVsID09IDApIHJldHVybiAnXCI8c3BhbiBjbGFzcz1cImdvb2RcIj5Hb29kPC9zcGFuPlwiJztcclxuICAgICAgICAgICAgICAgIGlmKGxldmVsID09IDEpIHJldHVybiAnXCI8c3BhbiBjbGFzcz1cImF2ZXJhZ2VcIj5NaW5vciBBbGVydDwvc3Bhbj5cIic7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJ1wiPHNwYW4gY2xhc3M9XCJiYWRcIj5NYWpvciBBbGVydDwvc3Bhbj5cIic7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGdlbmVyYXRlSHJlZjogZnVuY3Rpb24gKHBhcmFtZXRlcnMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBib2R5ID0gJCgnYm9keScpOyAvLyBGb3Igc29tZSBmdWNraW5nIHJlYXNvbiwgZGF0YSBpcyBzdG9yZWQgaW4gdGhlIGJvZHkgdGFnLlxyXG4gICAgICAgICAgICAgICAgX3VybFBhcmFtZXRlcnMgPSBib2R5LmRhdGEoJ3VybFBhcmFtZXRlcnMnKTtcclxuICAgICAgICAgICAgICAgIHZhciBxdWVyeVN0cmluZyA9ICc/JztcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gX3VybFBhcmFtZXRlcnMpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKF91cmxQYXJhbWV0ZXJzLmhhc093blByb3BlcnR5KGtleSkpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocXVlcnlTdHJpbmcgIT09ICc/JylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlTdHJpbmcgKz0gJzsnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nICs9IGtleSArICc9JyArIF91cmxQYXJhbWV0ZXJzW2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBwYXJhbWV0ZXJzKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJhbWV0ZXJzLmhhc093blByb3BlcnR5KGtleSkpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocXVlcnlTdHJpbmcgIT09ICc/JylcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnlTdHJpbmcgKz0gJzsnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5U3RyaW5nICs9IGtleSArICc9JyArIHBhcmFtZXRlcnNba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcXVlcnlTdHJpbmc7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIC8vIERpc3BsYXkgRE5BIEJsb2NrcyAoZm9yIHRoZSBETkEgTW9kaWZpZXIgVUkpXHJcbiAgICAgICAgICAgIGRpc3BsYXlETkFCbG9ja3M6IGZ1bmN0aW9uKGRuYVN0cmluZywgc2VsZWN0ZWRCbG9jaywgc2VsZWN0ZWRTdWJibG9jaywgYmxvY2tTaXplLCBwYXJhbUtleSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFkbmFTdHJpbmcpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc8ZGl2IGNsYXNzPVwibm90aWNlXCI+UGxlYXNlIHBsYWNlIGEgdmFsaWQgc3ViamVjdCBpbnRvIHRoZSBETkEgbW9kaWZpZXIuPC9kaXY+JztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgY2hhcmFjdGVycyA9IGRuYVN0cmluZy5zcGxpdCgnJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGh0bWwgPSAnPGRpdiBjbGFzcz1cImRuYUJsb2NrXCI+PGRpdiBjbGFzcz1cImxpbmsgZG5hQmxvY2tOdW1iZXJcIj4xPC9kaXY+JztcclxuICAgICAgICAgICAgICAgIHZhciBibG9jayA9IDE7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3ViYmxvY2sgPSAxO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggaW4gY2hhcmFjdGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hhcmFjdGVycy5oYXNPd25Qcm9wZXJ0eShpbmRleCkgfHwgdHlwZW9mIGNoYXJhY3RlcnNbaW5kZXhdID09PSAnb2JqZWN0JylcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtZXRlcnM7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmFtS2V5LnRvVXBwZXJDYXNlKCkgPT0gJ1VJJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMgPSB7ICdzZWxlY3RVSUJsb2NrJyA6IGJsb2NrLCAnc2VsZWN0VUlTdWJibG9jaycgOiBzdWJibG9jayB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMgPSB7ICdzZWxlY3RTRUJsb2NrJyA6IGJsb2NrLCAnc2VsZWN0U0VTdWJibG9jaycgOiBzdWJibG9jayB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9ICdsaW5rQWN0aXZlJztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYmxvY2sgPT0gc2VsZWN0ZWRCbG9jayAmJiBzdWJibG9jayA9PSBzZWxlY3RlZFN1YmJsb2NrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9ICdzZWxlY3RlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8ZGl2IGNsYXNzPVwibGluayAnICsgc3RhdHVzICsgJyBkbmFTdWJCbG9ja1wiIGRhdGEtaHJlZj1cIicgKyBOYW5vVXRpbGl0eS5nZW5lcmF0ZUhyZWYocGFyYW1ldGVycykgKyAnXCIgaWQ9XCJkbmFCbG9jaycgKyBpbmRleCArICdcIj4nICsgY2hhcmFjdGVyc1tpbmRleF0gKyAnPC9kaXY+JztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaW5kZXgrKztcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggJSBibG9ja1NpemUgPT0gMCAmJiBpbmRleCA8IGNoYXJhY3RlcnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NrKys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YmJsb2NrID0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAnPC9kaXY+PGRpdiBjbGFzcz1cImRuYUJsb2NrXCI+PGRpdiBjbGFzcz1cImxpbmsgZG5hQmxvY2tOdW1iZXJcIj4nICsgYmxvY2sgKyAnPC9kaXY+JztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJibG9jaysrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8L2Rpdj4nO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBodG1sO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjTWlycm9yOiBmdW5jdGlvbih0ZXh0Ym94KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgZWRpdG9yID0gQ29kZU1pcnJvci5mcm9tVGV4dEFyZWEoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGV4dGJveCksIHtcclxuICAgICAgICAgICAgICAgICAgICBsaW5lTnVtYmVyczogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBpbmRlbnRVbml0OiA0LFxyXG4gICAgICAgICAgICAgICAgICAgIGluZGVudFdpdGhUYWJzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoZW1lOiBcImxlc3Nlci1kYXJrXCJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzbW9vdGhOdW1iZXI6IGZ1bmN0aW9uKG51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRpZCA9IE5hbm9UcmFuc2l0aW9uLmFsbG9jSUQoXCJuXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiAnPHNwYW4gY2xhc3M9XCInICsgdGlkICsgJ1wiPjwvc3Bhbj48c2NyaXB0PiQoZnVuY3Rpb24oKSB7IHZhciBuZXdTdGF0ZSA9IHt2YWx1ZTogJyArIG51bWJlciArICd9OyB2YXIgb2xkID0gTmFub1RyYW5zaXRpb24udXBkYXRlRWxlbWVudChcIicgKyB0aWQgKyAnXCIsIG5ld1N0YXRlKTsgTmFub1RyYW5zaXRpb24uYW5pbWF0ZVRleHRWYWx1ZShcIicgKyB0aWQgKyAnXCIsIG51bGwsIC0xLCBvbGRbXCJ2YWx1ZVwiXSwgbmV3U3RhdGVbXCJ2YWx1ZVwiXSk7IH0pOzwvc2NyaXB0Pic7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNtb290aFJvdW5kOiBmdW5jdGlvbihudW1iZXIsIHBsYWNlcykge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRpZCA9IE5hbm9UcmFuc2l0aW9uLmFsbG9jSUQocGxhY2VzKTtcclxuICAgICAgICAgICAgICAgIGlmKHBsYWNlcyA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlZCA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuICc8c3BhbiBjbGFzcz1cIicgKyB0aWQgKyAnXCI+PC9zcGFuPjxzY3JpcHQ+JChmdW5jdGlvbigpIHsgdmFyIG5ld1N0YXRlID0ge3ZhbHVlOiAnICsgbnVtYmVyLnRvRml4ZWQocGxhY2VzKSArICd9OyB2YXIgb2xkID0gTmFub1RyYW5zaXRpb24udXBkYXRlRWxlbWVudChcIicgKyB0aWQgKyAnXCIsIG5ld1N0YXRlKTsgTmFub1RyYW5zaXRpb24uYW5pbWF0ZVRleHRWYWx1ZShcIicgKyB0aWQgKyAnXCIsIG51bGwsICcgKyBwbGFjZXMgKyAnLCBvbGRbXCJ2YWx1ZVwiXSwgbmV3U3RhdGVbXCJ2YWx1ZVwiXSk7IH0pOzwvc2NyaXB0Pic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgYWRkSGVscGVyczogZnVuY3Rpb24gKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIE5hbm9UZW1wbGF0ZS5hZGRIZWxwZXJzKF9iYXNlSGVscGVycyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgcmVtb3ZlSGVscGVyczogZnVuY3Rpb24gKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGhlbHBlcktleSBpbiBfYmFzZUhlbHBlcnMpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGlmIChfYmFzZUhlbHBlcnMuaGFzT3duUHJvcGVydHkoaGVscGVyS2V5KSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBOYW5vVGVtcGxhdGUucmVtb3ZlSGVscGVyKGhlbHBlcktleSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KCk7XHJcblxuXHJcbk5hbm9TdGF0ZURlZmF1bHRDbGFzcy5pbmhlcml0c0Zyb20oTmFub1N0YXRlQ2xhc3MpO1xyXG52YXIgTmFub1N0YXRlRGVmYXVsdCA9IG5ldyBOYW5vU3RhdGVEZWZhdWx0Q2xhc3MoKTtcclxuXHJcbmZ1bmN0aW9uIE5hbm9TdGF0ZURlZmF1bHRDbGFzcygpIHtcclxuXHJcbiAgICB0aGlzLmtleSA9ICdkZWZhdWx0JztcclxuXHJcbiAgICAvL3RoaXMucGFyZW50LmNvbnN0cnVjdG9yLmNhbGwodGhpcyk7XHJcblxyXG4gICAgdGhpcy5rZXkgPSB0aGlzLmtleS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICAgIE5hbm9TdGF0ZU1hbmFnZXIuYWRkU3RhdGUodGhpcyk7XHJcbn1cclxuXG5OYW5vU3RhdGVQREFDbGFzcy5pbmhlcml0c0Zyb20oTmFub1N0YXRlQ2xhc3MpO1xyXG52YXIgTmFub1N0YXRlUERBID0gbmV3IE5hbm9TdGF0ZVBEQUNsYXNzKCk7XHJcblxyXG5mdW5jdGlvbiBOYW5vU3RhdGVQREFDbGFzcygpIHtcclxuICAgIHRoaXMua2V5ID0gJ3BkYSc7XHJcbiAgICB0aGlzLmtleSA9IHRoaXMua2V5LnRvTG93ZXJDYXNlKCk7XHJcblx0dGhpcy5jdXJyZW50X3RlbXBsYXRlID0gXCJcIjtcclxuXHJcbiAgICBOYW5vU3RhdGVNYW5hZ2VyLmFkZFN0YXRlKHRoaXMpO1xyXG59XHJcblx0XHJcbk5hbm9TdGF0ZVBEQUNsYXNzLnByb3RvdHlwZS5vblVwZGF0ZSA9IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHROYW5vU3RhdGVDbGFzcy5wcm90b3R5cGUub25VcGRhdGUuY2FsbCh0aGlzLCBkYXRhKTtcclxuXHR2YXIgc3RhdGUgPSB0aGlzO1xyXG5cdFxyXG5cdHRyeSB7XHJcblx0XHRpZihkYXRhWydkYXRhJ11bJ2FwcCddICE9IG51bGwpIHtcclxuXHRcdFx0dmFyIHRlbXBsYXRlID0gZGF0YVsnZGF0YSddWydhcHAnXVsndGVtcGxhdGUnXTtcclxuXHRcdFx0aWYodGVtcGxhdGUgIT0gbnVsbCAmJiB0ZW1wbGF0ZSAhPSBzdGF0ZS5jdXJyZW50X3RlbXBsYXRlKSB7XHJcblx0XHRcdFx0JC53aGVuKCQuYWpheCh7XHJcblx0XHRcdFx0XHR1cmw6IHRlbXBsYXRlICsgJy50bXBsJyxcclxuXHRcdFx0XHRcdGNhY2hlOiBmYWxzZSxcclxuXHRcdFx0XHRcdGRhdGFUeXBlOiAndGV4dCdcclxuXHRcdFx0XHR9KSlcclxuXHRcdFx0XHQuZG9uZShmdW5jdGlvbih0ZW1wbGF0ZU1hcmt1cCkge1xyXG5cdFx0XHRcdFx0dGVtcGxhdGVNYXJrdXAgKz0gJzxkaXYgY2xhc3M9XCJjbGVhckJvdGhcIj48L2Rpdj4nO1xyXG5cclxuXHRcdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHRcdE5hbm9UZW1wbGF0ZS5hZGRUZW1wbGF0ZSgnYXBwJywgdGVtcGxhdGVNYXJrdXApO1xyXG5cdFx0XHRcdFx0XHROYW5vVGVtcGxhdGUucmVzZXRUZW1wbGF0ZSgnYXBwJyk7XHJcblx0XHRcdFx0XHRcdCQoXCIjdWlBcHBcIikuaHRtbChOYW5vVGVtcGxhdGUucGFyc2UoJ2FwcCcsIGRhdGEpKTtcclxuXHRcdFx0XHRcdFx0c3RhdGUuY3VycmVudF90ZW1wbGF0ZSA9IHRlbXBsYXRlO1xyXG5cdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0c3RhdGUub25BZnRlclVwZGF0ZShkYXRhKTtcclxuXHRcdFx0XHRcdH0gY2F0Y2goZXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0cmVwb3J0RXJyb3IoJ0VSUk9SOiBBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBsb2FkaW5nIHRoZSBQREEgQXBwIFVJOiAnICsgZXJyb3IubWVzc2FnZSk7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KVxyXG5cdFx0XHRcdC5mYWlsKCBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHRyZXBvcnRFcnJvcignRVJST1I6IExvYWRpbmcgdGVtcGxhdGUgYXBwKCcgKyB0ZW1wbGF0ZSArICcpIGZhaWxlZCEnKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRpZiAoTmFub1RlbXBsYXRlLnRlbXBsYXRlRXhpc3RzKCdhcHAnKSkge1xyXG5cdFx0XHRcdFx0JChcIiN1aUFwcFwiKS5odG1sKE5hbm9UZW1wbGF0ZS5wYXJzZSgnYXBwJywgZGF0YSkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH0gY2F0Y2goZXJyb3IpIHtcclxuXHRcdHJlcG9ydEVycm9yKCdFUlJPUjogQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgcmVuZGVyaW5nIHRoZSBQREEgQXBwIFVJOiAnICsgZXJyb3IubWVzc2FnZSk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG59XG4vLyBUaGlzIGlzIHRoZSBiYXNlIHN0YXRlIGNsYXNzLCBpdCBpcyBub3QgdG8gYmUgdXNlZCBkaXJlY3RseVxyXG5cclxuZnVuY3Rpb24gTmFub1N0YXRlQ2xhc3MoKSB7fVxyXG5cclxuTmFub1N0YXRlQ2xhc3MucHJvdG90eXBlLmtleSA9IG51bGw7XHJcbk5hbm9TdGF0ZUNsYXNzLnByb3RvdHlwZS5sYXlvdXRSZW5kZXJlZCA9IGZhbHNlO1xyXG5OYW5vU3RhdGVDbGFzcy5wcm90b3R5cGUuY29udGVudFJlbmRlcmVkID0gZmFsc2U7XHJcbk5hbm9TdGF0ZUNsYXNzLnByb3RvdHlwZS5tYXBJbml0aWFsaXNlZCA9IGZhbHNlO1xyXG5cclxuTmFub1N0YXRlQ2xhc3MucHJvdG90eXBlLmlzQ3VycmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiBOYW5vU3RhdGVNYW5hZ2VyLmdldEN1cnJlbnRTdGF0ZSgpID09IHRoaXM7XHJcbn07XHJcblxyXG5OYW5vU3RhdGVDbGFzcy5wcm90b3R5cGUub25BZGQgPSBmdW5jdGlvbiAocHJldmlvdXNTdGF0ZSkge1xyXG4gICAgLy8gRG8gbm90IGFkZCBjb2RlIGhlcmUsIGFkZCBpdCB0byB0aGUgJ2RlZmF1bHQnIHN0YXRlIChuYW5vX3N0YXRlX2RlZmF1dC5qcykgb3IgY3JlYXRlIGEgbmV3IHN0YXRlIGFuZCBvdmVycmlkZSB0aGlzIGZ1bmN0aW9uXHJcblxyXG4gICAgTmFub0Jhc2VDYWxsYmFja3MuYWRkQ2FsbGJhY2tzKCk7XHJcbiAgICBOYW5vQmFzZUhlbHBlcnMuYWRkSGVscGVycygpO1xyXG59O1xyXG5cclxuTmFub1N0YXRlQ2xhc3MucHJvdG90eXBlLm9uUmVtb3ZlID0gZnVuY3Rpb24gKG5leHRTdGF0ZSkge1xyXG4gICAgLy8gRG8gbm90IGFkZCBjb2RlIGhlcmUsIGFkZCBpdCB0byB0aGUgJ2RlZmF1bHQnIHN0YXRlIChuYW5vX3N0YXRlX2RlZmF1dC5qcykgb3IgY3JlYXRlIGEgbmV3IHN0YXRlIGFuZCBvdmVycmlkZSB0aGlzIGZ1bmN0aW9uXHJcblxyXG4gICAgTmFub0Jhc2VDYWxsYmFja3MucmVtb3ZlQ2FsbGJhY2tzKCk7XHJcbiAgICBOYW5vQmFzZUhlbHBlcnMucmVtb3ZlSGVscGVycygpO1xyXG59O1xyXG5cclxuTmFub1N0YXRlQ2xhc3MucHJvdG90eXBlLm9uQmVmb3JlVXBkYXRlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgIC8vIERvIG5vdCBhZGQgY29kZSBoZXJlLCBhZGQgaXQgdG8gdGhlICdkZWZhdWx0JyBzdGF0ZSAobmFub19zdGF0ZV9kZWZhdXQuanMpIG9yIGNyZWF0ZSBhIG5ldyBzdGF0ZSBhbmQgb3ZlcnJpZGUgdGhpcyBmdW5jdGlvblxyXG5cclxuICAgIGRhdGEgPSBOYW5vU3RhdGVNYW5hZ2VyLmV4ZWN1dGVCZWZvcmVVcGRhdGVDYWxsYmFja3MoZGF0YSk7XHJcblxyXG4gICAgcmV0dXJuIGRhdGE7IC8vIFJldHVybiBkYXRhIHRvIGNvbnRpbnVlLCByZXR1cm4gZmFsc2UgdG8gcHJldmVudCBvblVwZGF0ZSBhbmQgb25BZnRlclVwZGF0ZVxyXG59O1xyXG5cclxuTmFub1N0YXRlQ2xhc3MucHJvdG90eXBlLm9uVXBkYXRlID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgIC8vIERvIG5vdCBhZGQgY29kZSBoZXJlLCBhZGQgaXQgdG8gdGhlICdkZWZhdWx0JyBzdGF0ZSAobmFub19zdGF0ZV9kZWZhdXQuanMpIG9yIGNyZWF0ZSBhIG5ldyBzdGF0ZSBhbmQgb3ZlcnJpZGUgdGhpcyBmdW5jdGlvblxyXG5cclxuICAgIHRyeVxyXG4gICAge1xyXG4gICAgICAgIGlmICghdGhpcy5sYXlvdXRSZW5kZXJlZCB8fCAoZGF0YVsnY29uZmlnJ10uaGFzT3duUHJvcGVydHkoJ2F1dG9VcGRhdGVMYXlvdXQnKSAmJiBkYXRhWydjb25maWcnXVsnYXV0b1VwZGF0ZUxheW91dCddKSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgICQoXCIjdWlMYXlvdXRcIikuaHRtbChOYW5vVGVtcGxhdGUucGFyc2UoJ2xheW91dCcsIGRhdGEpKTsgLy8gcmVuZGVyIHRoZSAnbWFpbCcgdGVtcGxhdGUgdG8gdGhlICNtYWluVGVtcGxhdGUgZGl2XHJcbiAgICAgICAgICAgIHRoaXMubGF5b3V0UmVuZGVyZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMuY29udGVudFJlbmRlcmVkIHx8IChkYXRhWydjb25maWcnXS5oYXNPd25Qcm9wZXJ0eSgnYXV0b1VwZGF0ZUNvbnRlbnQnKSAmJiBkYXRhWydjb25maWcnXVsnYXV0b1VwZGF0ZUNvbnRlbnQnXSkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAkKFwiI3VpQ29udGVudFwiKS5odG1sKE5hbm9UZW1wbGF0ZS5wYXJzZSgnbWFpbicsIGRhdGEpKTsgLy8gcmVuZGVyIHRoZSAnbWFpbCcgdGVtcGxhdGUgdG8gdGhlICNtYWluVGVtcGxhdGUgZGl2XHJcbiAgICAgICAgICAgIHRoaXMuY29udGVudFJlbmRlcmVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKE5hbm9UZW1wbGF0ZS50ZW1wbGF0ZUV4aXN0cygnbWFwQ29udGVudCcpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLm1hcEluaXRpYWxpc2VkKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAvLyBBZGQgZHJhZyBmdW5jdGlvbmFsaXR5IHRvIHRoZSBtYXAgdWlcclxuICAgICAgICAgICAgICAgICQoJyN1aU1hcCcpLmRyYWdnYWJsZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICQoJyN1aU1hcFRvb2x0aXAnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vZmYoJ2NsaWNrJylcclxuICAgICAgICAgICAgICAgICAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcykuZmFkZU91dCg0MDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMubWFwSW5pdGlhbGlzZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkKFwiI3VpTWFwQ29udGVudFwiKS5odG1sKE5hbm9UZW1wbGF0ZS5wYXJzZSgnbWFwQ29udGVudCcsIGRhdGEpKTsgLy8gcmVuZGVyIHRoZSAnbWFwQ29udGVudCcgdGVtcGxhdGUgdG8gdGhlICN1aU1hcENvbnRlbnQgZGl2XHJcblxyXG4gICAgICAgICAgICBpZiAoZGF0YVsnY29uZmlnJ10uaGFzT3duUHJvcGVydHkoJ3Nob3dNYXAnKSAmJiBkYXRhWydjb25maWcnXVsnc2hvd01hcCddKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAkKCcjdWlDb250ZW50JykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xyXG4gICAgICAgICAgICAgICAgJCgnI3VpTWFwV3JhcHBlcicpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICQoJyN1aU1hcFdyYXBwZXInKS5hZGRDbGFzcygnaGlkZGVuJyk7XHJcbiAgICAgICAgICAgICAgICAkKCcjdWlDb250ZW50JykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChOYW5vVGVtcGxhdGUudGVtcGxhdGVFeGlzdHMoJ21hcEhlYWRlcicpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgJChcIiN1aU1hcEhlYWRlclwiKS5odG1sKE5hbm9UZW1wbGF0ZS5wYXJzZSgnbWFwSGVhZGVyJywgZGF0YSkpOyAvLyByZW5kZXIgdGhlICdtYXBIZWFkZXInIHRlbXBsYXRlIHRvIHRoZSAjdWlNYXBIZWFkZXIgZGl2XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChOYW5vVGVtcGxhdGUudGVtcGxhdGVFeGlzdHMoJ21hcEZvb3RlcicpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgJChcIiN1aU1hcEZvb3RlclwiKS5odG1sKE5hbm9UZW1wbGF0ZS5wYXJzZSgnbWFwRm9vdGVyJywgZGF0YSkpOyAvLyByZW5kZXIgdGhlICdtYXBGb290ZXInIHRlbXBsYXRlIHRvIHRoZSAjdWlNYXBGb290ZXIgZGl2XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY2F0Y2goZXJyb3IpXHJcbiAgICB7XHJcbiAgICAgICAgcmVwb3J0RXJyb3IoJ0VSUk9SOiBBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSByZW5kZXJpbmcgdGhlIFVJOiAnICsgZXJyb3IubWVzc2FnZSk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG59O1xyXG5cclxuTmFub1N0YXRlQ2xhc3MucHJvdG90eXBlLm9uQWZ0ZXJVcGRhdGUgPSBmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgLy8gRG8gbm90IGFkZCBjb2RlIGhlcmUsIGFkZCBpdCB0byB0aGUgJ2RlZmF1bHQnIHN0YXRlIChuYW5vX3N0YXRlX2RlZmF1dC5qcykgb3IgY3JlYXRlIGEgbmV3IHN0YXRlIGFuZCBvdmVycmlkZSB0aGlzIGZ1bmN0aW9uXHJcblxyXG4gICAgTmFub1N0YXRlTWFuYWdlci5leGVjdXRlQWZ0ZXJVcGRhdGVDYWxsYmFja3MoZGF0YSk7XHJcbn07XHJcblxyXG5OYW5vU3RhdGVDbGFzcy5wcm90b3R5cGUuYWxlcnRUZXh0ID0gZnVuY3Rpb24gKHRleHQpIHtcclxuICAgIC8vIERvIG5vdCBhZGQgY29kZSBoZXJlLCBhZGQgaXQgdG8gdGhlICdkZWZhdWx0JyBzdGF0ZSAobmFub19zdGF0ZV9kZWZhdXQuanMpIG9yIGNyZWF0ZSBhIG5ldyBzdGF0ZSBhbmQgb3ZlcnJpZGUgdGhpcyBmdW5jdGlvblxyXG5cclxuICAgIGFsZXJ0KHRleHQpO1xyXG59O1xyXG5cblxyXG52YXIgTmFub1RlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBfdGVtcGxhdGVEYXRhID0ge307XHJcblxyXG4gICAgdmFyIF90ZW1wbGF0ZXMgPSB7fTtcclxuICAgIHZhciBfY29tcGlsZWRUZW1wbGF0ZXMgPSB7fTtcclxuICAgIFxyXG4gICAgdmFyIF9oZWxwZXJzID0ge307XHJcblxyXG4gICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gV2Ugc3RvcmUgdGVtcGxhdGVEYXRhIGluIHRoZSBib2R5IHRhZywgaXQncyBhcyBnb29kIGEgcGxhY2UgYXMgYW55XHJcbiAgICAgICAgX3RlbXBsYXRlRGF0YSA9ICQoJ2JvZHknKS5kYXRhKCd0ZW1wbGF0ZURhdGEnKTtcclxuXHJcbiAgICAgICAgaWYgKF90ZW1wbGF0ZURhdGEgPT0gbnVsbClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJlcG9ydEVycm9yKCdFcnJvcjogVGVtcGxhdGUgZGF0YSBkaWQgbm90IGxvYWQgY29ycmVjdGx5LicpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9hZE5leHRUZW1wbGF0ZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgbG9hZE5leHRUZW1wbGF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAvLyB3ZSBjb3VudCB0aGUgbnVtYmVyIG9mIHRlbXBsYXRlcyBmb3IgdGhpcyB1aSBzbyB0aGF0IHdlIGtub3cgd2hlbiB0aGV5J3ZlIGFsbCBiZWVuIHJlbmRlcmVkXHJcbiAgICAgICAgdmFyIHRlbXBsYXRlQ291bnQgPSBPYmplY3Quc2l6ZShfdGVtcGxhdGVEYXRhKTtcclxuXHJcbiAgICAgICAgaWYgKCF0ZW1wbGF0ZUNvdW50KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgJChkb2N1bWVudCkudHJpZ2dlcigndGVtcGxhdGVzTG9hZGVkJyk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGxvYWQgbWFya3VwIGZvciBlYWNoIHRlbXBsYXRlIGFuZCByZWdpc3RlciBpdFxyXG4gICAgICAgIGZvciAodmFyIGtleSBpbiBfdGVtcGxhdGVEYXRhKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYgKCFfdGVtcGxhdGVEYXRhLmhhc093blByb3BlcnR5KGtleSkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkLndoZW4oJC5hamF4KHtcclxuICAgICAgICAgICAgICAgICAgICB1cmw6IF90ZW1wbGF0ZURhdGFba2V5XSxcclxuICAgICAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICd0ZXh0J1xyXG4gICAgICAgICAgICAgICAgfSkpXHJcbiAgICAgICAgICAgICAgICAuZG9uZSggZnVuY3Rpb24odGVtcGxhdGVNYXJrdXApIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVNYXJrdXAgKz0gJzxkaXYgY2xhc3M9XCJjbGVhckJvdGhcIj48L2Rpdj4nO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBOYW5vVGVtcGxhdGUuYWRkVGVtcGxhdGUoa2V5LCB0ZW1wbGF0ZU1hcmt1cCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhdGNoKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcG9ydEVycm9yKCdFUlJPUjogQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgbG9hZGluZyB0aGUgVUk6ICcgKyBlcnJvci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIF90ZW1wbGF0ZURhdGFba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBsb2FkTmV4dFRlbXBsYXRlKCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmZhaWwoIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXBvcnRFcnJvcignRVJST1I6IExvYWRpbmcgdGVtcGxhdGUgJyArIGtleSArICcoJyArIF90ZW1wbGF0ZURhdGFba2V5XSArICcpIGZhaWxlZCEnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIGNvbXBpbGVUZW1wbGF0ZXMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgZm9yICh2YXIga2V5IGluIF90ZW1wbGF0ZXMpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIF9jb21waWxlZFRlbXBsYXRlc1trZXldID0gZG9ULnRlbXBsYXRlKF90ZW1wbGF0ZXNba2V5XSwgbnVsbCwgX3RlbXBsYXRlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICByZXBvcnRFcnJvcihlcnJvci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGFkZFRlbXBsYXRlOiBmdW5jdGlvbiAoa2V5LCB0ZW1wbGF0ZVN0cmluZykge1xyXG4gICAgICAgICAgICBfdGVtcGxhdGVzW2tleV0gPSB0ZW1wbGF0ZVN0cmluZztcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRlbXBsYXRlRXhpc3RzOiBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBfdGVtcGxhdGVzLmhhc093blByb3BlcnR5KGtleSk7XHJcbiAgICAgICAgfSxcclxuXHRcdHJlc2V0VGVtcGxhdGU6IGZ1bmN0aW9uIChrZXkpIHtcclxuXHRcdFx0X2NvbXBpbGVkVGVtcGxhdGVzW2tleV0gPSBudWxsO1xyXG5cdFx0fSxcclxuICAgICAgICBwYXJzZTogZnVuY3Rpb24gKHRlbXBsYXRlS2V5LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmICghX2NvbXBpbGVkVGVtcGxhdGVzLmhhc093blByb3BlcnR5KHRlbXBsYXRlS2V5KSB8fCAhX2NvbXBpbGVkVGVtcGxhdGVzW3RlbXBsYXRlS2V5XSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFfdGVtcGxhdGVzLmhhc093blByb3BlcnR5KHRlbXBsYXRlS2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcG9ydEVycm9yKCdFUlJPUjogVGVtcGxhdGUgXCInICsgdGVtcGxhdGVLZXkgKyAnXCIgZG9lcyBub3QgZXhpc3QgaW4gX2NvbXBpbGVkVGVtcGxhdGVzIScpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGgyPlRlbXBsYXRlIGVycm9yIChkb2VzIG5vdCBleGlzdCk8L2gyPic7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb21waWxlVGVtcGxhdGVzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBfY29tcGlsZWRUZW1wbGF0ZXNbdGVtcGxhdGVLZXldICE9ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgIHJlcG9ydEVycm9yKF9jb21waWxlZFRlbXBsYXRlc1t0ZW1wbGF0ZUtleV0pO1xyXG4gICAgICAgICAgICAgICAgcmVwb3J0RXJyb3IoJ0VSUk9SOiBUZW1wbGF0ZSBcIicgKyB0ZW1wbGF0ZUtleSArICdcIiBmYWlsZWQgdG8gY29tcGlsZSEnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAnPGgyPlRlbXBsYXRlIGVycm9yIChmYWlsZWQgdG8gY29tcGlsZSk8L2gyPic7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIF9jb21waWxlZFRlbXBsYXRlc1t0ZW1wbGF0ZUtleV0uY2FsbCh0aGlzLCBkYXRhWydkYXRhJ10sIGRhdGFbJ2NvbmZpZyddLCBfaGVscGVycyk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBhZGRIZWxwZXI6IGZ1bmN0aW9uIChoZWxwZXJOYW1lLCBoZWxwZXJGdW5jdGlvbikge1xyXG4gICAgICAgICAgICBpZiAoIWpRdWVyeS5pc0Z1bmN0aW9uKGhlbHBlckZ1bmN0aW9uKSkge1xyXG4gICAgICAgICAgICAgICAgcmVwb3J0RXJyb3IoJ05hbm9UZW1wbGF0ZS5hZGRIZWxwZXIgZmFpbGVkIHRvIGFkZCAnICsgaGVscGVyTmFtZSArICcgYXMgaXQgaXMgbm90IGEgZnVuY3Rpb24uJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47IFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBfaGVscGVyc1toZWxwZXJOYW1lXSA9IGhlbHBlckZ1bmN0aW9uO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYWRkSGVscGVyczogZnVuY3Rpb24gKGhlbHBlcnMpIHsgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IgKHZhciBoZWxwZXJOYW1lIGluIGhlbHBlcnMpIHtcclxuICAgICAgICAgICAgICAgIGlmICghaGVscGVycy5oYXNPd25Qcm9wZXJ0eShoZWxwZXJOYW1lKSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIE5hbm9UZW1wbGF0ZS5hZGRIZWxwZXIoaGVscGVyTmFtZSwgaGVscGVyc1toZWxwZXJOYW1lXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlbW92ZUhlbHBlcjogZnVuY3Rpb24gKGhlbHBlck5hbWUpIHtcclxuICAgICAgICAgICAgaWYgKGhlbHBlcnMuaGFzT3duUHJvcGVydHkoaGVscGVyTmFtZSkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSBfaGVscGVyc1toZWxwZXJOYW1lXTtcclxuICAgICAgICAgICAgfSAgIFxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0oKTtcclxuXG5OYW5vVHJhbnNpdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG5cdHZhciBpZENhY2hlID0ge307XHJcblx0dmFyIHN0YXRlQ2FjaGUgPSB7fTtcclxuXHR2YXIgY3VycmVudElEID0gMDtcclxuXHJcblx0TmFub1N0YXRlTWFuYWdlci5hZGRCZWZvcmVVcGRhdGVDYWxsYmFjayhcIlRyYW5zaXRpb25SZXNldFwiLCBmdW5jdGlvbih1cGRhdGVEYXRhKSB7XHJcblx0XHRjdXJyZW50SUQgPSAwO1xyXG5cdFx0cmV0dXJuIHVwZGF0ZURhdGE7XHJcblx0fSk7XHJcblxyXG5cdC8vIGdldCBhIHRyYW5zaXRpb24gaGFuZGxlLCBhZGQgdGhpcyB0byB5b3VyIGVsZW1lbnQncyBjbGFzc1xyXG5cdHZhciBfYWxsb2NJRCA9IGZ1bmN0aW9uKHVuaXF1ZUlEKSB7XHJcblx0XHRpZih1bmlxdWVJRCA9PSBcIl9IaWRlX01hcF9jbG9zZVwiKSAvLyBoYWNrIGJlY2F1c2UgbmFubyBkb2VzIHdlaXJkIHRoaW5nIG9uIGZpcnN0IHRpY2tcclxuXHRcdFx0cmV0dXJuIFwidHJhbnNpdGlvbl9fbWFwXCI7XHJcblxyXG5cdFx0aWYodW5pcXVlSUQgPT09IHVuZGVmaW5lZClcclxuXHRcdFx0dW5pcXVlSUQgPSBcIlwiO1xyXG5cdFx0cmV0dXJuIFwidHJhbnNpdGlvbl9fXCIgKyAoY3VycmVudElEKyspICsgXCJfXCIgKyB1bmlxdWVJRC50b1N0cmluZygpO1xyXG5cdH1cclxuXHJcblx0Ly8gc2V0dXAgdHJhbnNpdGlvbnMsIGNhbGwgdGhpcyBleGFjdGx5IG9uY2UgYSByZWZyZXNoLCByZXR1cm5zIG9sZCBzdGF0ZVxyXG5cdHZhciBfdXBkYXRlRWxlbWVudCA9IGZ1bmN0aW9uKGlkLCBuZXdTdGF0ZSwgbWVyZ2UpIHtcclxuXHRcdHZhciBjYWNoZSA9IGlkQ2FjaGVbaWRdO1xyXG5cdFx0dmFyIG9sZFN0YXRlO1xyXG5cclxuXHRcdGlmKG1lcmdlID09PSB1bmRlZmluZWQpXHJcblx0XHRcdG1lcmdlID0gZmFsc2U7XHJcblxyXG5cdFx0dmFyIGVsZW1lbnQgPSAkKFwiLlwiICsgaWQpO1xyXG5cdFx0aWYoZWxlbWVudC5sZW5ndGggPT0gMClcclxuXHRcdFx0cmV0dXJuIG5ld1N0YXRlO1xyXG5cclxuXHRcdC8vIHZlcmlmeSB0aGF0IHRoZSBpZCBzdGlsbCBwb2ludHMgdG8gdGhlIHNhbWUgdGhpbmdcclxuXHRcdC8vIGFuZCBnZXQgb2xkIHN0YXRlXHJcblx0XHRlbGVtZW50ID0gZWxlbWVudFswXTtcclxuXHRcdGlmKGNhY2hlXHJcblx0XHRcdCYmIGNhY2hlLnRhZ05hbWUgPT0gZWxlbWVudC50YWdOYW1lXHJcblx0XHRcdCYmIGNhY2hlLnRhYkluZGV4ID09IGVsZW1lbnQudGFiSW5kZXhcclxuXHRcdFx0JiYgY2FjaGUucGFyZW50ID09IGVsZW1lbnQucGFyZW50Tm9kZS50YWdOYW1lXHJcblx0XHRcdCYmIGNhY2hlLmNoaWxkcmVuID09IGVsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoKSB7XHJcblxyXG5cdFx0XHQvLyB5ZXAsIHRoaXMgaXMgY29udGludWF0aW9uIG9mIG9sZCBvYmplY3RcclxuXHRcdFx0b2xkU3RhdGUgPSBzdGF0ZUNhY2hlW2lkXTtcclxuXHJcblx0XHRcdGlmKG1lcmdlKSB7XHJcblx0XHRcdFx0dmFyIG5ld1N0YXRlQ29weSA9IHt9O1xyXG5cdFx0XHRcdGZvcihrIGluIG9sZFN0YXRlKVxyXG5cdFx0XHRcdFx0bmV3U3RhdGVDb3B5W2tdID0gb2xkU3RhdGVba107XHJcblx0XHRcdFx0Zm9yKGsgaW4gbmV3U3RhdGUpXHJcblx0XHRcdFx0XHRuZXdTdGF0ZUNvcHlba10gPSBuZXdTdGF0ZVtrXTtcclxuXHRcdFx0XHRuZXdTdGF0ZSA9IG5ld1N0YXRlQ29weTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gbm9wIVxyXG5cdFx0XHRvbGRTdGF0ZSA9IG5ld1N0YXRlO1xyXG5cclxuXHRcdFx0aWRDYWNoZVtpZF0gPSB7XHJcblx0XHRcdFx0dGFnTmFtZTogZWxlbWVudC50YWdOYW1lLFxyXG5cdFx0XHRcdHRhYkluZGV4OiBlbGVtZW50LnRhYkluZGV4LFxyXG5cdFx0XHRcdHBhcmVudDogZWxlbWVudC5wYXJlbnROb2RlLnRhZ05hbWUsXHJcblx0XHRcdFx0Y2hpbGRyZW46IGVsZW1lbnQuY2hpbGRyZW4ubGVuZ3RoXHJcblx0XHRcdH07XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gc2F2ZSBuZXcgc3RhdGUgZm9yIG5leHQgY3ljbGVcclxuXHRcdHN0YXRlQ2FjaGVbaWRdID0gbmV3U3RhdGU7XHJcblx0XHRyZXR1cm4gb2xkU3RhdGU7XHJcblx0fVxyXG5cclxuXHR2YXIgX3Jlc29sdmVUYXJnZXQgPSBmdW5jdGlvbihpZCwgZmlsdGVyKSB7XHJcblx0XHR2YXIgZWxlbWVudCA9ICQoXCIuXCIgKyBpZCk7XHJcblxyXG5cdFx0cmV0dXJuIGZpbHRlciA/ICQoZWxlbWVudCkuY2hpbGRyZW4oZmlsdGVyKSA6ICQoZWxlbWVudCk7XHJcblx0fVxyXG5cclxuXHQvLyBhbmltYXRlIGEgc3RhdGUgY2hhbmdlXHJcblx0dmFyIF9hbmltYXRlRWxlbWVudCA9IGZ1bmN0aW9uKGlkLCBmaWx0ZXIsIG9sZFN0YXRlLCBuZXdTdGF0ZSwgdGltZSkge1xyXG5cdFx0dmFyIHRhcmdldCA9IF9yZXNvbHZlVGFyZ2V0KGlkLCBmaWx0ZXIpO1xyXG5cclxuXHRcdGlmKHRpbWUgPT09IHVuZGVmaW5lZClcclxuXHRcdFx0dGltZSA9IDE5MDA7XHJcblxyXG5cdFx0Ly8gIGRvIHRoZSBhbmltYXRpb25cclxuXHRcdHRhcmdldFxyXG5cdFx0XHQuY3NzKG9sZFN0YXRlKVxyXG5cdFx0XHQuYW5pbWF0ZShuZXdTdGF0ZSwge1xyXG5cdFx0XHRcdGR1cmF0aW9uOiB0aW1lLFxyXG5cdFx0XHRcdHF1ZXVlOiBmYWxzZVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHQvLyBtYXliZSBjbGFzcyB0b28/XHJcblx0XHR2YXIgb2xkQ2xhc3MgPSBvbGRTdGF0ZVtcIi4uY2xhc3NcIl07XHJcblx0XHR2YXIgbmV3Q2xhc3MgPSBuZXdTdGF0ZVtcIi4uY2xhc3NcIl07XHJcblx0XHRpZihvbGRDbGFzcyAmJiBuZXdDbGFzcykge1xyXG5cdFx0XHR0YXJnZXQuYWRkQ2xhc3Mob2xkQ2xhc3MpO1xyXG5cdFx0XHRpZihvbGRDbGFzcyAhPSBuZXdDbGFzcykge1xyXG5cdFx0XHRcdC8vIHN0cmlwIGNsYXNzZXMgdGhhdCBhcmUgaW4gYm90aFxyXG5cdFx0XHRcdHZhciBvbGRDbGFzcyA9IG9sZENsYXNzLnNwbGl0KFwiIFwiKTtcclxuXHRcdFx0XHR2YXIgbmV3Q2xhc3MgPSBuZXdDbGFzcy5zcGxpdChcIiBcIik7XHJcblxyXG5cdFx0XHRcdHZhciBmaWx0ZXJlZE9sZENsYXNzID0gb2xkQ2xhc3MuZmlsdGVyKGZ1bmN0aW9uKHgpIHsgcmV0dXJuIG5ld0NsYXNzLmluZGV4T2YoeCkgPT0gLTE7IH0pO1xyXG5cdFx0XHRcdHZhciBmaWx0ZXJlZE5ld0NsYXNzID0gbmV3Q2xhc3MuZmlsdGVyKGZ1bmN0aW9uKHgpIHsgcmV0dXJuIG9sZENsYXNzLmluZGV4T2YoeCkgPT0gLTE7IH0pO1xyXG5cclxuXHRcdFx0XHRvbGRDbGFzcyA9IGZpbHRlcmVkT2xkQ2xhc3Muam9pbihcIiBcIik7XHJcblx0XHRcdFx0bmV3Q2xhc3MgPSBmaWx0ZXJlZE5ld0NsYXNzLmpvaW4oXCIgXCIpO1xyXG5cclxuXHRcdFx0XHR0YXJnZXQuc3dpdGNoQ2xhc3Mob2xkQ2xhc3MsIG5ld0NsYXNzLCB7XHJcblx0XHRcdFx0XHRkdXJhdGlvbjogdGltZSxcclxuXHRcdFx0XHRcdHF1ZXVlOiBmYWxzZVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR2YXIgX2FuaW1hdGVUZXh0VmFsdWUgPSBmdW5jdGlvbihpZCwgZmlsdGVyLCBwbGFjZXMsIG9sZFZhbHVlLCBuZXdWYWx1ZSwgdGltZSkge1xyXG5cdFx0dmFyIHRhcmdldCA9IF9yZXNvbHZlVGFyZ2V0KGlkLCBmaWx0ZXIpO1xyXG5cclxuXHRcdGlmKHRpbWUgPT09IHVuZGVmaW5lZClcclxuXHRcdFx0dGltZSA9IDE5MDA7XHJcblxyXG5cdFx0aWYocGxhY2VzID09IC0xKVxyXG5cdFx0XHR0YXJnZXQudGV4dChvbGRWYWx1ZS50b1N0cmluZygpKTsvL29sZFZhbHVlLnRvU3RyaW5nKCkpO1xyXG5cdFx0ZWxzZVxyXG5cdFx0XHR0YXJnZXQudGV4dChvbGRWYWx1ZS50b0ZpeGVkKHBsYWNlcykpOy8vb2xkVmFsdWUudG9GaXhlZChwbGFjZXMpKTtcclxuXHJcblx0XHRpZihvbGRWYWx1ZSAhPSBuZXdWYWx1ZSlcclxuXHRcdFx0dGFyZ2V0LmFuaW1hdGUoe2k6IDF9LCB7XHJcblx0XHRcdFx0ZHVyYXRpb246IHRpbWUsXHJcblx0XHRcdFx0cXVldWU6IGZhbHNlLFxyXG5cdFx0XHRcdHN0ZXA6IGZ1bmN0aW9uKG5vdywgZngpIHtcclxuXHRcdFx0XHRcdGlmKHBsYWNlcyA9PSAtMSkge1xyXG5cdFx0XHRcdFx0XHRmeC5lbGVtLnRleHRDb250ZW50ID0gKG9sZFZhbHVlICogKDEgLSBub3cpICsgbmV3VmFsdWUgKiBub3cpLnRvU3RyaW5nKCk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRmeC5lbGVtLnRleHRDb250ZW50ID0gKG9sZFZhbHVlICogKDEgLSBub3cpICsgbmV3VmFsdWUgKiBub3cpLnRvRml4ZWQocGxhY2VzKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdH1cclxuXHJcblx0dmFyIF9hbmltYXRlSG92ZXIgPSBmdW5jdGlvbihpZCwgZmlsdGVyLCBvbGRTdGF0ZSwgbmV3U3RhdGUsIHRpbWUpIHtcclxuXHRcdHZhciB0YXJnZXQgPSBfcmVzb2x2ZVRhcmdldChpZCwgZmlsdGVyKTtcclxuXHJcblx0XHRpZih0aW1lID09PSB1bmRlZmluZWQpXHJcblx0XHRcdHRpbWUgPSAyMDA7XHJcblxyXG5cdFx0aWYob2xkU3RhdGVbXCIuLmhvdmVyXCJdKVxyXG5cdFx0XHR0YXJnZXQuYWRkQ2xhc3MoXCJob3ZlclwiKTtcclxuXHJcblx0XHR0YXJnZXQuaG92ZXIoXHJcblx0XHRcdGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHRhcmdldC5zdG9wKDEsIDEpLmFkZENsYXNzKFwiaG92ZXJcIiwge1xyXG5cdFx0XHRcdFx0ZHVyYXRpb246IHRpbWUsXHJcblx0XHRcdFx0XHRxdWV1ZTogZmFsc2VcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRfdXBkYXRlRWxlbWVudChpZCwge1wiLi5ob3ZlclwiOiB0cnVlfSwgdHJ1ZSk7XHJcblx0XHRcdH0sXHJcblx0XHRcdGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdHRhcmdldC5zdG9wKDEsIDEpLnJlbW92ZUNsYXNzKFwiaG92ZXJcIiwge1xyXG5cdFx0XHRcdFx0ZHVyYXRpb246IHRpbWUsXHJcblx0XHRcdFx0XHRxdWV1ZTogZmFsc2VcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRfdXBkYXRlRWxlbWVudChpZCwge1wiLi5ob3ZlclwiOiBmYWxzZX0sIHRydWUpO1xyXG5cdFx0XHR9XHJcblx0XHQpO1xyXG5cdH1cclxuXHJcblx0Ly8gaGVscGVyIGZvciBtb3N0IGNvbW1vbiB1c2VcclxuXHR2YXIgX3RyYW5zaXRpb25FbGVtZW50ID0gZnVuY3Rpb24oaWQsIGZpbHRlciwgc3RhdGUsIHRpbWUpIHtcclxuXHRcdHZhciBvbGQgPSBfdXBkYXRlRWxlbWVudChpZCwgc3RhdGUpO1xyXG5cdFx0X2FuaW1hdGVFbGVtZW50KGlkLCBmaWx0ZXIsIG9sZCwgc3RhdGUsIHRpbWUpO1xyXG5cdFx0cmV0dXJuIG9sZDtcclxuXHR9XHJcblxyXG5cdHJldHVybiB7XHJcblx0XHRhbGxvY0lEOiBfYWxsb2NJRCxcclxuXHRcdHVwZGF0ZUVsZW1lbnQ6IF91cGRhdGVFbGVtZW50LFxyXG5cdFx0YW5pbWF0ZUVsZW1lbnQ6IF9hbmltYXRlRWxlbWVudCxcclxuXHRcdGFuaW1hdGVUZXh0VmFsdWU6IF9hbmltYXRlVGV4dFZhbHVlLFxyXG5cdFx0YW5pbWF0ZUhvdmVyOiBfYW5pbWF0ZUhvdmVyLFxyXG5cdFx0dHJhbnNpdGlvbkVsZW1lbnQ6IF90cmFuc2l0aW9uRWxlbWVudFxyXG5cdH07XHJcbn0oKTtcclxuXG52YXIgTmFub1dpbmRvdyA9IGZ1bmN0aW9uICgpIFxyXG57XHJcbiAgICB2YXIgb2Zmc2V0WCwgb2Zmc2V0WTtcclxuICAgIHZhciBtaW5XaWR0aCA9IDI4MDtcclxuICAgIHZhciBtaW5IZWlnaHQgPSAxNDA7XHJcblxyXG4gICAgdmFyIHNldFBvcyA9IGZ1bmN0aW9uICh4LCB5KSB7XHJcbiAgICAgICAgTmFub1V0aWxpdHkud2luc2V0KFwicG9zXCIsIHggKyBcIixcIiArIHkpO1xyXG4gICAgfTtcclxuICAgIHZhciBzZXRTaXplID0gZnVuY3Rpb24gKHcsIGgpIHtcclxuICAgICAgIE5hbm9VdGlsaXR5LndpbnNldChcInNpemVcIiwgdyArIFwiLFwiICsgaCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBvYmV5TGltaXRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIEFsaWdubWVudCAoVGhhbmtzIEdvb24gKENDIEJZLU5DLVNBIHYzKSlcclxuICAgICAgICB2YXIgcHJldlggPSB3aW5kb3cuc2NyZWVuTGVmdDtcclxuICAgICAgICB2YXIgcHJldlkgPSB3aW5kb3cuc2NyZWVuVG9wO1xyXG4gICAgICAgIC8vUHV0IHRoZSB3aW5kb3cgYXQgdG9wIGxlZnRcclxuICAgICAgICBzZXRQb3MoMCwgMCk7XHJcbiAgICAgICAgLy9HZXQgYW55IG9mZnNldHMgc3RpbGwgcHJlc2VudFxyXG4gICAgICAgIG9mZnNldFggPSB3aW5kb3cuc2NyZWVuTGVmdDtcclxuICAgICAgICBvZmZzZXRZID0gd2luZG93LnNjcmVlblRvcDtcclxuICAgICAgICAvLyBDbGFtcCBpdCB0byB0aGUgdmlld3BvcnRcclxuICAgICAgICB2YXIgY2xhbXBlZFggPSBwcmV2WCAtIG9mZnNldFg7XHJcbiAgICAgICAgdmFyIGNsYW1wZWRZID0gcHJldlkgLSBvZmZzZXRZO1xyXG4gICAgICAgIGNsYW1wZWRYID0gY2xhbXBlZFggPCBvZmZzZXRYID8gMCA6IGNsYW1wZWRYO1xyXG4gICAgICAgIGNsYW1wZWRZID0gY2xhbXBlZFkgPCBvZmZzZXRZID8gMCA6IGNsYW1wZWRZO1xyXG4gICAgICAgIC8vIFB1dCBpdCBiYWNrXHJcbiAgICAgICAgc2V0UG9zKGNsYW1wZWRYLCBjbGFtcGVkWSlcclxuICAgICAgICAvLyBEb25lIHdpdGggYWxpZ25tZW50XHJcblxyXG4gICAgICAgIC8vIFNpemUgY29uc3RyYWludHNcclxuICAgICAgICB2YXIgaGVpZ2h0ID0gJCh3aW5kb3cpLmhlaWdodCgpO1xyXG4gICAgICAgIHZhciB3aWR0aCA9ICQod2luZG93KS53aWR0aCgpO1xyXG4gICAgICAgIGlmKCQoXCJib2R5XCIpLmhlaWdodCgpID49ICgkKHdpbmRvdykuaGVpZ2h0KCkgLSAyOSkpIHsgLy8gU2Nyb2xsYmFyISEhXHJcbiAgICAgICAgICAgIHdpZHRoICs9IDE3IC8vIDE3IHBpeGVscyBpcyB0aGUgd2lkdGggb2YgYSBzY3JvbGxiYXJcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoJChkb2N1bWVudCkud2lkdGgoKSA+ICQod2luZG93KS53aWR0aCgpKSB7IC8vIEhvcml6b250YWwgU2Nyb2xsYmFyISEhXHJcbiAgICAgICAgICAgIGhlaWdodCArPSAxN1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgbmV3V2lkdGggPSBNYXRoLm1heChtaW5XaWR0aCwgd2lkdGgpO1xyXG4gICAgICAgIHZhciBuZXdIZWlnaHQgPSBNYXRoLm1heChtaW5IZWlnaHQsIGhlaWdodCk7XHJcbiAgICAgICAgc2V0U2l6ZShuZXdXaWR0aCwgbmV3SGVpZ2h0KTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLyogV2Ugd2FudCBuYW5vVUkgd2luZG93cyB0byBvYmV5IHRoZSBsaW1pdHMgcmVnYXJkbGVzcywgXHJcbiAgICAgICAgYW5kIHdlJ3JlIGhpamFja2luZyB0aGlzIGxpYnJhcnkgdG8gZG8gc28sIGV2ZW4gaWYgZmFuY3kgbW9kZSBpcyB0dXJuZWQgb2ZmLlxyXG4gICAgICAgIFRvIGJlIGZhaXIsIHRoaXMgZG9lc24ndCBzdG9wIHRoZSB1c2VyIGZyb20gc2hyaW5raW5nIHRoZW0gcGFzdCB0aGVpciBpbnRlbmRlZCBsaW1pdCB3aGVuIHRoZXkncmUgbm90IGluIGZhbmN5IG1vZGUsIFxyXG4gICAgICAgIGJ1dCBpdCdzIGEgbmljZSBzYWZlZ3VhcmQgYWdhaW5zdCBzaG9kZGlseS1jb2RlZCBVSXMuICovXHJcbiAgICAgICAgb2JleUxpbWl0cygpO1xyXG5cclxuICAgICAgICBpZighTmFub1N0YXRlTWFuYWdlci5nZXREYXRhKCkuY29uZmlnLnVzZXIuZmFuY3kpIHtcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmYW5jeUNocm9tZSgpO1xyXG4gICAgICAgIC8vIC4uLiBidXQgd2hlbiBmYW5jeSBtb2RlIGlzIHR1cm5lZCBvbiwgd2UgaGF2ZSB0byBkbyBpdCBhZ2FpbiB0byBtYWtlIHN1cmVcclxuICAgICAgICAvLyB0aGF0IHRoZSB3aW5kb3cgb2Zmc2V0cyBhcmUgY29ycmVjdCBmb3IgdGhlIHNsaWdodGx5IGRpZmZlcmVudCB3aW5kb3cuXHJcbiAgICAgICAgb2JleUxpbWl0cygpO1xyXG4gXHJcbiAgICAgICAgYXR0YWNoQnV0dG9ucygpO1xyXG4gICAgICAgIGF0dGFjaERyYWdBbmRSZXNpemUoKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGZhbmN5Q2hyb21lID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgTmFub1V0aWxpdHkud2luc2V0KFwidGl0bGViYXJcIiwgMCk7XHJcbiAgICAgICAgTmFub1V0aWxpdHkud2luc2V0KFwiY2FuLXJlc2l6ZVwiLCAwKTtcclxuICAgICAgICBOYW5vVXRpbGl0eS53aW5zZXQoXCJ0cmFuc3BhcmVudC1jb2xvclwiLCBcIiNGRjAwRTRcIilcclxuICAgICAgICAkKCcuZmFuY3knKS5zaG93KCk7XHJcbiAgICAgICAgJCgnI3VpVGl0bGVGbHVmZicpLmNzcyhcInJpZ2h0XCIsIFwiNzJweFwiKTtcclxuICAgICAgICAkKCcuc3RhdHVzaWNvbicpLmNzcyhcImxlZnRcIiwgXCIzNHB4XCIpO1xyXG4gICAgICAgICQoJyN1aVRpdGxlVGV4dCcpLmNzcyhcImxlZnRcIiwgXCI2NnB4XCIpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgYXR0YWNoQnV0dG9ucyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBjbG9zZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gTmFub1V0aWxpdHkuY2xvc2UoKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBtaW5pbWl6ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gTmFub1V0aWxpdHkud2luc2V0KFwiaXMtbWluaW1pemVkXCIsIFwidHJ1ZVwiKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgICQoXCIuY2xvc2VcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKFwiLm1pbmltaXplXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIG1pbmltaXplKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBhdHRhY2hEcmFnQW5kUmVzaXplID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLyogRHJhZyAqL1xyXG4gICAgICAgICQoXCJib2R5XCIpLm9uKFwibW91c2Vtb3ZlXCIsIFwiI3VpVGl0bGVXcmFwcGVyXCIsIGZ1bmN0aW9uIChldikge1xyXG4gICAgICAgICAgICBkcmFnKGV2KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJChcImJvZHlcIikub24oXCJtb3VzZWRvd25cIiwgXCIjdWlUaXRsZVdyYXBwZXJcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBkcmFnZ2luZyA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICgkKHRoaXMpWzBdLnNldENhcHR1cmUpIHsgJCh0aGlzKVswXS5zZXRDYXB0dXJlKCk7IH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJChcImJvZHlcIikub24oXCJtb3VzZXVwXCIsIFwiI3VpVGl0bGVXcmFwcGVyXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgZHJhZ2dpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKCQodGhpcylbMF0ucmVsZWFzZUNhcHR1cmUpIHsgJCh0aGlzKVswXS5yZWxlYXNlQ2FwdHVyZSgpOyB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8qIFJlc2l6ZSAqL1xyXG4gICAgICAgICQoXCJib2R5XCIpLm9uKFwibW91c2Vtb3ZlXCIsIFwiZGl2LnJlc2l6ZUFyZWFcIiwgZnVuY3Rpb24gKGV2KSB7XHJcbiAgICAgICAgICAgIHJlc2l6ZS5jYWxsKHRoaXMsIGV2KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJChcImJvZHlcIikub24oXCJtb3VzZWRvd25cIiwgXCJkaXYucmVzaXplQXJlYVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJlc2l6aW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0Q2FwdHVyZSkgeyB0aGlzLnNldENhcHR1cmUoKTsgfVxyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgICQoXCJib2R5XCIpLm9uKFwibW91c2V1cFwiLCBcImRpdi5yZXNpemVBcmVhXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmVzaXppbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMucmVsZWFzZUNhcHR1cmUpIHsgdGhpcy5yZWxlYXNlQ2FwdHVyZSgpOyB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qIFN0b2xlbiBHb29uIGNvZGUgZnR3IChDQyBCWS1OQy1TQSB2My4wKSAqL1xyXG4gICAgdmFyIGRyYWdnaW5nLCBsYXN0WCwgbGFzdFk7XHJcbiAgICB2YXIgZHJhZyA9IGZ1bmN0aW9uIChldikge1xyXG4gICAgICAgIGV2ID0gZXYgfHwgd2luZG93LmV2ZW50O1xyXG4gICAgICAgIGlmIChsYXN0WCA9PT0gZXYuc2NyZWVuWCAmJiBsYXN0WSA9PT0gZXYuc2NyZWVuWSkge1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChsYXN0WCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGxhc3RYID0gZXYuc2NyZWVuWDtcclxuICAgICAgICAgICAgbGFzdFkgPSBldi5jbGllbnRZO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGRyYWdnaW5nKSB7XHJcbiAgICAgICAgICAgIHZhciBkeCA9IChldi5zY3JlZW5YIC0gbGFzdFgpO1xyXG4gICAgICAgICAgICB2YXIgZHkgPSAoZXYuc2NyZWVuWSAtIGxhc3RZKTtcclxuICAgICAgICAgICAgZHggKz0gd2luZG93LnNjcmVlbkxlZnQgLSBvZmZzZXRYO1xyXG4gICAgICAgICAgICBkeSArPSB3aW5kb3cuc2NyZWVuVG9wIC0gb2Zmc2V0WTtcclxuXHJcbiAgICAgICAgICAgIHNldFBvcyhkeCwgZHkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGFzdFggPSBldi5zY3JlZW5YO1xyXG4gICAgICAgIGxhc3RZID0gZXYuc2NyZWVuWTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgcmVzaXppbmcsIHJlc2l6ZVdvcmtpbmdcclxuICAgIHZhciByZXNpemUgPSBmdW5jdGlvbiAoZXYpIHtcclxuICAgICAgICBpZiAocmVzaXplV29ya2luZykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXNpemVXb3JraW5nID0gdHJ1ZTtcclxuICAgICAgICBldiA9IGV2IHx8IHdpbmRvdy5ldmVudDtcclxuXHJcbiAgICAgICAgaWYgKGxhc3RYID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgbGFzdFggPSBldi5zY3JlZW5YIC0gb2Zmc2V0WDtcclxuICAgICAgICAgICAgbGFzdFkgPSBldi5zY3JlZW5ZIC0gb2Zmc2V0WTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChyZXNpemluZykge1xyXG4gICAgICAgICAgICB2YXIgd2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTtcclxuICAgICAgICAgICAgdmFyIGhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKTtcclxuXHJcbiAgICAgICAgICAgIGlmKCQoXCJib2R5XCIpLmhlaWdodCgpID49ICgkKHdpbmRvdykuaGVpZ2h0KCkgLSAyOSkpIHsgLy8gVmVydGljYWwgU2Nyb2xsYmFyISEhXHJcbiAgICAgICAgICAgICAgICB3aWR0aCArPSAxNyAvLyAxNyBwaXhlbHMgaXMgdGhlIHdpZHRoIG9mIGEgc2Nyb2xsYmFyXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKCQoZG9jdW1lbnQpLndpZHRoKCkgPiAkKHdpbmRvdykud2lkdGgoKSkgeyAvLyBIb3Jpem9udGFsIFNjcm9sbGJhciEhIVxyXG4gICAgICAgICAgICAgICAgaGVpZ2h0ICs9IDE3XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciByeCA9IE51bWJlcigkKHRoaXMpLmF0dHIoXCJyeFwiKSk7XHJcbiAgICAgICAgICAgIHZhciByeSA9IE51bWJlcigkKHRoaXMpLmF0dHIoXCJyeVwiKSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgZHggPSAoKGV2LnNjcmVlblgtb2Zmc2V0WCkgLSBsYXN0WCk7XHJcbiAgICAgICAgICAgIHZhciBkeSA9ICgoZXYuc2NyZWVuWS1vZmZzZXRZKSAtIGxhc3RZKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciBuZXdYID0gd2luZG93LnNjcmVlbkxlZnQgLSBvZmZzZXRYO1xyXG4gICAgICAgICAgICB2YXIgbmV3WSA9IHdpbmRvdy5zY3JlZW5Ub3AgLSBvZmZzZXRZO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIG5ld1cgPSB3aWR0aCArIChkeCAqIHJ4KTtcclxuICAgICAgICAgICAgaWYocnggPT0gLTEpe1xyXG4gICAgICAgICAgICAgICAgbmV3WCArPSBkeDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgbmV3SCA9IGhlaWdodCArIChkeSAqIHJ5KTtcclxuICAgICAgICAgICAgaWYocnkgPT0gLTEpe1xyXG4gICAgICAgICAgICAgICAgbmV3WSArPSBkeTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbmV3VyA9IE1hdGgubWF4KG1pbldpZHRoLCBuZXdXKTtcclxuICAgICAgICAgICAgbmV3SCA9IE1hdGgubWF4KG1pbkhlaWdodCwgbmV3SCk7IFxyXG4gICAgICAgICAgICBzZXRQb3MobmV3WCwgbmV3WSk7XHJcbiAgICAgICAgICAgIHNldFNpemUobmV3VywgbmV3SCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsYXN0WCA9IGV2LnNjcmVlblggLSBvZmZzZXRYO1xyXG4gICAgICAgIGxhc3RZID0gZXYuc2NyZWVuWSAtIG9mZnNldFk7XHJcblxyXG4gICAgICAgIHJlc2l6ZVdvcmtpbmcgPSBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvKiBFbmQgc3RvbGVuIEdvb24gY29kZSAqL1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkgeyAvL2NyYXp5IGJ1dCBlbnN1cmVzIGNvcnJlY3QgbG9hZCBvcmRlciAobmFub3V0aWwgLSBuYW5vdGVtcGxhdGUgLSBuYW5vd2luZG93KVxyXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5vbigndGVtcGxhdGVzTG9hZGVkJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgICAgICB9KTsgXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSgpOyJdfQ==
